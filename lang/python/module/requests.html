<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.59" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/lang/python/module/requests.html"><meta property="og:site_name" content="æ–‡æ¡£æ¼”ç¤º"><meta property="og:title" content="requests"><meta property="og:description" content="å®‰è£… æ ‡å‡†è¯·æ±‚ HTTP è¯·æ±‚ç±»å‹ get,post,put,delete,head,options åœ¨ URL ä¸­ä¼ é€’å‚æ•° å›å¤å†…å®¹ ç¼–ç  äºŒè¿›åˆ¶å“åº”å†…å®¹ å¯¹äºéæ–‡æœ¬è¯·æ±‚ï¼Œæ‚¨è¿˜å¯ä»¥å°†å“åº”æ­£æ–‡ä½œä¸ºå­—èŠ‚è®¿é—®ï¼š gzip å’Œ deflate ä¼ è¾“ç¼–ç ä¼šè‡ªåŠ¨ä¸ºæ‚¨è§£ç ã€‚ å¦‚æœå®‰è£…äº† brotli æˆ– brotlicffi ç­‰ Brotli åº“ï¼Œåˆ™ä¼šè‡ªåŠ¨ä¸ºæ‚¨è§£ç ..."><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-12-16T23:05:24.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-12-16T23:05:24.000Z"><meta name="referrer" content="never"><title>requests | æ–‡æ¡£æ¼”ç¤º</title><meta name="description" content="å®‰è£… æ ‡å‡†è¯·æ±‚ HTTP è¯·æ±‚ç±»å‹ get,post,put,delete,head,options åœ¨ URL ä¸­ä¼ é€’å‚æ•° å›å¤å†…å®¹ ç¼–ç  äºŒè¿›åˆ¶å“åº”å†…å®¹ å¯¹äºéæ–‡æœ¬è¯·æ±‚ï¼Œæ‚¨è¿˜å¯ä»¥å°†å“åº”æ­£æ–‡ä½œä¸ºå­—èŠ‚è®¿é—®ï¼š gzip å’Œ deflate ä¼ è¾“ç¼–ç ä¼šè‡ªåŠ¨ä¸ºæ‚¨è§£ç ã€‚ å¦‚æœå®‰è£…äº† brotli æˆ– brotlicffi ç­‰ Brotli åº“ï¼Œåˆ™ä¼šè‡ªåŠ¨ä¸ºæ‚¨è§£ç ...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-6a3f7c13.css" as="style"><link rel="stylesheet" href="/assets/style-6a3f7c13.css">
    <link rel="modulepreload" href="/assets/app-5ac1acdb.js"><link rel="modulepreload" href="/assets/framework-339c481e.js"><link rel="modulepreload" href="/assets/requests.html-946ca05d.js"><link rel="modulepreload" href="/assets/requests.html-b1779dae.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.png" alt="æ–‡æ¡£æ¼”ç¤º"><!----><span class="site-name hide-in-pad">æ–‡æ¡£æ¼”ç¤º</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="å’•å’•ä¹”çŸ¥è¯†åº“"><span class="icon iconfont icon-home"></span>å’•å’•ä¹”çŸ¥è¯†åº“<!----></a></div><div class="nav-item hide-in-mobile"><a href="/quicknav/" class="nav-link" aria-label="å¿«é€Ÿå¯¼èˆª"><span class="icon iconfont icon-navigation"></span>å¿«é€Ÿå¯¼èˆª<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Windows"><span class="title"><span class="icon iconfont icon-windows"></span>Windows</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/windows/bat/" class="nav-link" aria-label="Batch(æ‰¹å¤„ç†)"><span class="icon iconfont icon-actions"></span>Batch(æ‰¹å¤„ç†)<!----></a></li><li class="dropdown-item"><a href="/windows/powershell/" class="nav-link" aria-label="PowerShell"><span class="icon iconfont icon-shell"></span>PowerShell<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ç¼–ç¨‹è¯­è¨€"><span class="title"><span class="icon iconfont icon-language"></span>ç¼–ç¨‹è¯­è¨€</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/lang/python/" class="nav-link active" aria-label="Python"><span class="icon iconfont icon-python"></span>Python<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/linux/" class="nav-link" aria-label="Linux"><span class="icon iconfont icon-linux"></span>Linux<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><form class="search-box" role="search"><input type="search" placeholder="æœç´¢æœ¬ç«™" autocomplete="off" spellcheck="false" value><!----></form><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/lang/" class="nav-link sidebar-link sidebar-page" aria-label="ç¼–ç¨‹è¯­è¨€"><span class="icon iconfont icon-language"></span>ç¼–ç¨‹è¯­è¨€<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-python"></span><span class="title">Python</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/lang/python/" class="nav-link sidebar-link sidebar-page" aria-label="Python"><span class="icon iconfont icon-python"></span>Python<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/lang/python/install.html" class="nav-link sidebar-link sidebar-page" aria-label="å®‰è£…"><!---->å®‰è£…<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/lang/python/var.html" class="nav-link sidebar-link sidebar-page" aria-label="å˜é‡"><!---->å˜é‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/lang/python/control.html" class="nav-link sidebar-link sidebar-page" aria-label="ç¨‹åºæ§åˆ¶"><!---->ç¨‹åºæ§åˆ¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/lang/python/function.html" class="nav-link sidebar-link sidebar-page" aria-label="å‡½æ•°"><!---->å‡½æ•°<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-code"></span><span class="title">æ¨¡å—</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/lang/python/module/" class="nav-link sidebar-link sidebar-page" aria-label="æ¨¡å—"><span class="icon iconfont icon-code"></span>æ¨¡å—<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/lang/python/module/pipreqs.html" class="nav-link sidebar-link sidebar-page" aria-label="pipreqs(ç”Ÿæˆrequirements.txt)"><!---->pipreqs(ç”Ÿæˆrequirements.txt)<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/lang/python/module/requests.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="requests"><!---->requests<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#å®‰è£…" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®‰è£…"><!---->å®‰è£…<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#æ ‡å‡†è¯·æ±‚" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ ‡å‡†è¯·æ±‚"><!---->æ ‡å‡†è¯·æ±‚<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#http-è¯·æ±‚ç±»å‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HTTP è¯·æ±‚ç±»å‹"><!---->HTTP è¯·æ±‚ç±»å‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#åœ¨-url-ä¸­ä¼ é€’å‚æ•°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åœ¨ URL ä¸­ä¼ é€’å‚æ•°"><!---->åœ¨ URL ä¸­ä¼ é€’å‚æ•°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#å›å¤å†…å®¹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å›å¤å†…å®¹"><!---->å›å¤å†…å®¹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#ç¼–ç " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç¼–ç "><!---->ç¼–ç <!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#äºŒè¿›åˆ¶å“åº”å†…å®¹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="äºŒè¿›åˆ¶å“åº”å†…å®¹"><!---->äºŒè¿›åˆ¶å“åº”å†…å®¹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#jsonå“åº”å†…å®¹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JSONå“åº”å†…å®¹"><!---->JSONå“åº”å†…å®¹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#åŸå§‹å“åº”å†…å®¹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŸå§‹å“åº”å†…å®¹"><!---->åŸå§‹å“åº”å†…å®¹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#è‡ªå®šä¹‰header" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è‡ªå®šä¹‰Header"><!---->è‡ªå®šä¹‰Header<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#æ›´å¤æ‚çš„-post-è¯·æ±‚" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ›´å¤æ‚çš„ POST è¯·æ±‚"><!---->æ›´å¤æ‚çš„ POST è¯·æ±‚<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#å‘å¸ƒä¸€ä¸ªå¤šéƒ¨åˆ†ç¼–ç çš„æ–‡ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‘å¸ƒä¸€ä¸ªå¤šéƒ¨åˆ†ç¼–ç çš„æ–‡ä»¶"><!---->å‘å¸ƒä¸€ä¸ªå¤šéƒ¨åˆ†ç¼–ç çš„æ–‡ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#å“åº”çŠ¶æ€ä»£ç " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å“åº”çŠ¶æ€ä»£ç "><!---->å“åº”çŠ¶æ€ä»£ç <!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#å“åº”æ ‡å¤´" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å“åº”æ ‡å¤´"><!---->å“åº”æ ‡å¤´<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#cookies" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Cookies"><!---->Cookies<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#é‡å®šå‘å’Œå†å²" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é‡å®šå‘å’Œå†å²"><!---->é‡å®šå‘å’Œå†å²<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#è¶…æ—¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¶…æ—¶"><!---->è¶…æ—¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#é”™è¯¯å’Œå¼‚å¸¸" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é”™è¯¯å’Œå¼‚å¸¸"><!---->é”™è¯¯å’Œå¼‚å¸¸<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#ä¼šè¯å¯¹è±¡-session" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¼šè¯å¯¹è±¡(Session)"><!---->ä¼šè¯å¯¹è±¡(Session)<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#è¯·æ±‚å’Œå“åº”å¯¹è±¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¯·æ±‚å’Œå“åº”å¯¹è±¡"><!---->è¯·æ±‚å’Œå“åº”å¯¹è±¡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#å‡†å¤‡å¥½çš„è¯·æ±‚-apiç¤ºä¾‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‡†å¤‡å¥½çš„è¯·æ±‚(APIç¤ºä¾‹)"><!---->å‡†å¤‡å¥½çš„è¯·æ±‚(APIç¤ºä¾‹)<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#ssl-è¯ä¹¦éªŒè¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SSL è¯ä¹¦éªŒè¯"><!---->SSL è¯ä¹¦éªŒè¯<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#å®¢æˆ·ç«¯è¯ä¹¦" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®¢æˆ·ç«¯è¯ä¹¦"><!---->å®¢æˆ·ç«¯è¯ä¹¦<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#ca-è¯ä¹¦" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="CA è¯ä¹¦"><!---->CA è¯ä¹¦<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#æ­£æ–‡å†…å®¹å·¥ä½œæµç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ­£æ–‡å†…å®¹å·¥ä½œæµç¨‹"><!---->æ­£æ–‡å†…å®¹å·¥ä½œæµç¨‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#æ´»ç€-belive" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ´»ç€(Belive)"><!---->æ´»ç€(Belive)<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#æµå¼ä¸Šä¼ -upload" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æµå¼ä¸Šä¼ (Upload)"><!---->æµå¼ä¸Šä¼ (Upload)<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#å—ç¼–ç è¯·æ±‚" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å—ç¼–ç è¯·æ±‚"><!---->å—ç¼–ç è¯·æ±‚<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#post-å¤šä¸ªå¤šéƒ¨åˆ†ç¼–ç æ–‡ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="POST å¤šä¸ªå¤šéƒ¨åˆ†ç¼–ç æ–‡ä»¶"><!---->POST å¤šä¸ªå¤šéƒ¨åˆ†ç¼–ç æ–‡ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#äº‹ä»¶æŒ‚é’©" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="äº‹ä»¶æŒ‚é’©"><!---->äº‹ä»¶æŒ‚é’©<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#è‡ªå®šä¹‰èº«ä»½éªŒè¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è‡ªå®šä¹‰èº«ä»½éªŒè¯"><!---->è‡ªå®šä¹‰èº«ä»½éªŒè¯<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#æµå¼ä¼ è¾“è¯·æ±‚" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æµå¼ä¼ è¾“è¯·æ±‚"><!---->æµå¼ä¼ è¾“è¯·æ±‚<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#ä»£ç†-proxy" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä»£ç†(Proxy)"><!---->ä»£ç†(Proxy)<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#socks5" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Socks5"><!---->Socks5<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#éµå®ˆè§„èŒƒ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="éµå®ˆè§„èŒƒ"><!---->éµå®ˆè§„èŒƒ<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#ç¼–ç -1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç¼–ç "><!---->ç¼–ç <!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#http-åŠ¨è¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HTTP åŠ¨è¯"><!---->HTTP åŠ¨è¯<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#è‡ªå®šä¹‰åŠ¨è¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è‡ªå®šä¹‰åŠ¨è¯"><!---->è‡ªå®šä¹‰åŠ¨è¯<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#é“¾æ¥å¤´" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é“¾æ¥å¤´"><!---->é“¾æ¥å¤´<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#ä¼ è¾“é€‚é…å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¼ è¾“é€‚é…å™¨"><!---->ä¼ è¾“é€‚é…å™¨<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#ç¤ºä¾‹-ç‰¹å®š-ssl-ç‰ˆæœ¬" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç¤ºä¾‹ï¼šç‰¹å®š SSL ç‰ˆæœ¬"><!---->ç¤ºä¾‹ï¼šç‰¹å®š SSL ç‰ˆæœ¬<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#é˜»å¡è¿˜æ˜¯éé˜»å¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é˜»å¡è¿˜æ˜¯éé˜»å¡ï¼Ÿ"><!---->é˜»å¡è¿˜æ˜¯éé˜»å¡ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#æ ‡é¢˜æ’åº" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ ‡é¢˜æ’åº"><!---->æ ‡é¢˜æ’åº<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/lang/python/module/requests.html#è¶…æ—¶-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¶…æ—¶"><!---->è¶…æ—¶<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li></ul></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->requests</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://docs.goojoe.top" target="_blank" rel="noopener noreferrer">å’•å’•ä¹”</a></span><span property="author" content="å’•å’•ä¹”"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2022-12-16T23:05:24.000Z"></span><!----><!----><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 33 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT33M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#å®‰è£…" class="router-link-active router-link-exact-active toc-link level2">å®‰è£…</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#æ ‡å‡†è¯·æ±‚" class="router-link-active router-link-exact-active toc-link level2">æ ‡å‡†è¯·æ±‚</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#http-è¯·æ±‚ç±»å‹" class="router-link-active router-link-exact-active toc-link level2">HTTP è¯·æ±‚ç±»å‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#åœ¨-url-ä¸­ä¼ é€’å‚æ•°" class="router-link-active router-link-exact-active toc-link level2">åœ¨ URL ä¸­ä¼ é€’å‚æ•°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#å›å¤å†…å®¹" class="router-link-active router-link-exact-active toc-link level2">å›å¤å†…å®¹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#ç¼–ç " class="router-link-active router-link-exact-active toc-link level2">ç¼–ç </a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#äºŒè¿›åˆ¶å“åº”å†…å®¹" class="router-link-active router-link-exact-active toc-link level2">äºŒè¿›åˆ¶å“åº”å†…å®¹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#jsonå“åº”å†…å®¹" class="router-link-active router-link-exact-active toc-link level2">JSONå“åº”å†…å®¹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#åŸå§‹å“åº”å†…å®¹" class="router-link-active router-link-exact-active toc-link level2">åŸå§‹å“åº”å†…å®¹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#è‡ªå®šä¹‰header" class="router-link-active router-link-exact-active toc-link level2">è‡ªå®šä¹‰Header</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#æ›´å¤æ‚çš„-post-è¯·æ±‚" class="router-link-active router-link-exact-active toc-link level2">æ›´å¤æ‚çš„ POST è¯·æ±‚</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#å‘å¸ƒä¸€ä¸ªå¤šéƒ¨åˆ†ç¼–ç çš„æ–‡ä»¶" class="router-link-active router-link-exact-active toc-link level2">å‘å¸ƒä¸€ä¸ªå¤šéƒ¨åˆ†ç¼–ç çš„æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#å“åº”çŠ¶æ€ä»£ç " class="router-link-active router-link-exact-active toc-link level2">å“åº”çŠ¶æ€ä»£ç </a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#å“åº”æ ‡å¤´" class="router-link-active router-link-exact-active toc-link level2">å“åº”æ ‡å¤´</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#cookies" class="router-link-active router-link-exact-active toc-link level2">Cookies</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#é‡å®šå‘å’Œå†å²" class="router-link-active router-link-exact-active toc-link level2">é‡å®šå‘å’Œå†å²</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#è¶…æ—¶" class="router-link-active router-link-exact-active toc-link level2">è¶…æ—¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#é”™è¯¯å’Œå¼‚å¸¸" class="router-link-active router-link-exact-active toc-link level2">é”™è¯¯å’Œå¼‚å¸¸</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#ä¼šè¯å¯¹è±¡-session" class="router-link-active router-link-exact-active toc-link level2">ä¼šè¯å¯¹è±¡(Session)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#è¯·æ±‚å’Œå“åº”å¯¹è±¡" class="router-link-active router-link-exact-active toc-link level2">è¯·æ±‚å’Œå“åº”å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#å‡†å¤‡å¥½çš„è¯·æ±‚-apiç¤ºä¾‹" class="router-link-active router-link-exact-active toc-link level2">å‡†å¤‡å¥½çš„è¯·æ±‚(APIç¤ºä¾‹)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#ssl-è¯ä¹¦éªŒè¯" class="router-link-active router-link-exact-active toc-link level2">SSL è¯ä¹¦éªŒè¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#å®¢æˆ·ç«¯è¯ä¹¦" class="router-link-active router-link-exact-active toc-link level2">å®¢æˆ·ç«¯è¯ä¹¦</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#ca-è¯ä¹¦" class="router-link-active router-link-exact-active toc-link level2">CA è¯ä¹¦</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#æ­£æ–‡å†…å®¹å·¥ä½œæµç¨‹" class="router-link-active router-link-exact-active toc-link level2">æ­£æ–‡å†…å®¹å·¥ä½œæµç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#æ´»ç€-belive" class="router-link-active router-link-exact-active toc-link level2">æ´»ç€(Belive)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#æµå¼ä¸Šä¼ -upload" class="router-link-active router-link-exact-active toc-link level2">æµå¼ä¸Šä¼ (Upload)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#å—ç¼–ç è¯·æ±‚" class="router-link-active router-link-exact-active toc-link level2">å—ç¼–ç è¯·æ±‚</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#post-å¤šä¸ªå¤šéƒ¨åˆ†ç¼–ç æ–‡ä»¶" class="router-link-active router-link-exact-active toc-link level2">POST å¤šä¸ªå¤šéƒ¨åˆ†ç¼–ç æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#äº‹ä»¶æŒ‚é’©" class="router-link-active router-link-exact-active toc-link level2">äº‹ä»¶æŒ‚é’©</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#è‡ªå®šä¹‰èº«ä»½éªŒè¯" class="router-link-active router-link-exact-active toc-link level2">è‡ªå®šä¹‰èº«ä»½éªŒè¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#æµå¼ä¼ è¾“è¯·æ±‚" class="router-link-active router-link-exact-active toc-link level2">æµå¼ä¼ è¾“è¯·æ±‚</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#ä»£ç†-proxy" class="router-link-active router-link-exact-active toc-link level2">ä»£ç†(Proxy)</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#socks5" class="router-link-active router-link-exact-active toc-link level3">Socks5</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#éµå®ˆè§„èŒƒ" class="router-link-active router-link-exact-active toc-link level2">éµå®ˆè§„èŒƒ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#ç¼–ç -1" class="router-link-active router-link-exact-active toc-link level3">ç¼–ç </a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#http-åŠ¨è¯" class="router-link-active router-link-exact-active toc-link level2">HTTP åŠ¨è¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#è‡ªå®šä¹‰åŠ¨è¯" class="router-link-active router-link-exact-active toc-link level2">è‡ªå®šä¹‰åŠ¨è¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#é“¾æ¥å¤´" class="router-link-active router-link-exact-active toc-link level2">é“¾æ¥å¤´</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#ä¼ è¾“é€‚é…å™¨" class="router-link-active router-link-exact-active toc-link level2">ä¼ è¾“é€‚é…å™¨</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#ç¤ºä¾‹-ç‰¹å®š-ssl-ç‰ˆæœ¬" class="router-link-active router-link-exact-active toc-link level3">ç¤ºä¾‹ï¼šç‰¹å®š SSL ç‰ˆæœ¬</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#é˜»å¡è¿˜æ˜¯éé˜»å¡" class="router-link-active router-link-exact-active toc-link level2">é˜»å¡è¿˜æ˜¯éé˜»å¡ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#æ ‡é¢˜æ’åº" class="router-link-active router-link-exact-active toc-link level2">æ ‡é¢˜æ’åº</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/lang/python/module/requests.html#è¶…æ—¶-1" class="router-link-active router-link-exact-active toc-link level2">è¶…æ—¶</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h2 id="å®‰è£…" tabindex="-1"><a class="header-anchor" href="#å®‰è£…" aria-hidden="true">#</a> å®‰è£…</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>pip install requests
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="æ ‡å‡†è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#æ ‡å‡†è¯·æ±‚" aria-hidden="true">#</a> æ ‡å‡†è¯·æ±‚</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>import requests
def resp(url):
    # å¤´éƒ¨
    headers = {
        &#39;Cookie&#39;:&#39;&#39;,
        &#39;User-Agent&#39;:&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.74 Safari/537.36&#39;
    }

    # è¯·æ±‚èµ„æº
    json = {}

    # ä»£ç†
    proxy = &#39;127.0.0.1:7890&#39;
    proxies = {
        &#39;http&#39;: proxy,
        &#39;https&#39;: proxy
    }
    url = url
    response = requests.get(url=url,data=json,headers=headers,proxies=proxies,verify=False)
    print(response.content.decode())

if __name__ == &#39;__main__&#39;:
    resp(&quot;&quot;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#è¯·æ±‚" aria-hidden="true">#</a> è¯·æ±‚</h1><h2 id="http-è¯·æ±‚ç±»å‹" tabindex="-1"><a class="header-anchor" href="#http-è¯·æ±‚ç±»å‹" aria-hidden="true">#</a> HTTP è¯·æ±‚ç±»å‹</h2><p>get,post,put,delete,head,options</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>import requests

r = requests.get(&#39;https://api.github.com/events&#39;)
r = requests.post(&#39;https://httpbin.org/post&#39;, data={&#39;key&#39;: &#39;value&#39;})
r = requests.put(&#39;https://httpbin.org/put&#39;, data={&#39;key&#39;: &#39;value&#39;})
r = requests.delete(&#39;https://httpbin.org/delete&#39;)
r = requests.head(&#39;https://httpbin.org/get&#39;)
r = requests.options(&#39;https://httpbin.org/get&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="åœ¨-url-ä¸­ä¼ é€’å‚æ•°" tabindex="-1"><a class="header-anchor" href="#åœ¨-url-ä¸­ä¼ é€’å‚æ•°" aria-hidden="true">#</a> åœ¨ URL ä¸­ä¼ é€’å‚æ•°</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>payload = {&#39;key1&#39;: &#39;value1&#39;, &#39;key2&#39;: &#39;value2&#39;}
r = requests.get(&#39;https://httpbin.org/get&#39;, params=payload)
print(r.url)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å›å¤å†…å®¹" tabindex="-1"><a class="header-anchor" href="#å›å¤å†…å®¹" aria-hidden="true">#</a> å›å¤å†…å®¹</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>import requests

r = requests.get(&#39;https://api.github.com/events&#39;)
r.text
&#39;[{&quot;repository&quot;:{&quot;open_issues&quot;:0,&quot;url&quot;:&quot;https://github.com/...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ç¼–ç " tabindex="-1"><a class="header-anchor" href="#ç¼–ç " aria-hidden="true">#</a> ç¼–ç </h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>r.encoding = &#39;ISO-8859-1&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="äºŒè¿›åˆ¶å“åº”å†…å®¹" tabindex="-1"><a class="header-anchor" href="#äºŒè¿›åˆ¶å“åº”å†…å®¹" aria-hidden="true">#</a> äºŒè¿›åˆ¶å“åº”å†…å®¹</h2><p>å¯¹äºéæ–‡æœ¬è¯·æ±‚ï¼Œæ‚¨è¿˜å¯ä»¥å°†å“åº”æ­£æ–‡ä½œä¸ºå­—èŠ‚è®¿é—®ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r.content
b&#39;[{&quot;repository&quot;:{&quot;open_issues&quot;:0,&quot;url&quot;:&quot;https://github.com/...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>gzip å’Œ deflate ä¼ è¾“ç¼–ç ä¼šè‡ªåŠ¨ä¸ºæ‚¨è§£ç ã€‚</p><p>å¦‚æœå®‰è£…äº† brotli æˆ– brotlicffi ç­‰ Brotli åº“ï¼Œåˆ™ä¼šè‡ªåŠ¨ä¸ºæ‚¨è§£ç  br ä¼ è¾“ç¼–ç ã€‚</p><p>ä¾‹å¦‚ï¼Œè¦ä»è¯·æ±‚è¿”å›çš„äºŒè¿›åˆ¶æ•°æ®åˆ›å»ºå›¾åƒï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>from PIL import Image
from io import BytesIO

i = Image.open(BytesIO(r.content))
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="jsonå“åº”å†…å®¹" tabindex="-1"><a class="header-anchor" href="#jsonå“åº”å†…å®¹" aria-hidden="true">#</a> JSONå“åº”å†…å®¹</h2><p>è¿˜æœ‰ä¸€ä¸ªå†…ç½®çš„ JSON è§£ç å™¨ï¼Œä»¥é˜²æ‚¨å¤„ç† JSON æ•°æ®ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; import requests

&gt;&gt;&gt; r = requests.get(&#39;https://api.github.com/events&#39;)
&gt;&gt;&gt; r.json()
[{&#39;repository&#39;: {&#39;open_issues&#39;: 0, &#39;url&#39;: &#39;https://github.com/...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœ JSON è§£ç å¤±è´¥ï¼Œr.json() ä¼šå¼•å‘å¼‚å¸¸ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå“åº”æ”¶åˆ° 204ï¼ˆæ— å†…å®¹ï¼‰ï¼Œæˆ–è€…å¦‚æœå“åº”åŒ…å«æ— æ•ˆçš„ JSONï¼Œåˆ™å°è¯• r.json() ä¼šå¼•å‘ requests.exceptions.JSONDecodeErrorã€‚æ­¤åŒ…è£…å¼‚å¸¸ä¸ºä¸åŒ python ç‰ˆæœ¬å’Œ json åºåˆ—åŒ–åº“å¯èƒ½å¼•å‘çš„å¤šä¸ªå¼‚å¸¸æä¾›äº’æ“ä½œæ€§ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè°ƒç”¨ r.json() æˆåŠŸå¹¶ä¸ä»£è¡¨å“åº”æˆåŠŸã€‚æŸäº›æœåŠ¡å™¨å¯èƒ½ä¼šåœ¨å¤±è´¥çš„å“åº”ä¸­è¿”å› JSON å¯¹è±¡ï¼ˆä¾‹å¦‚ HTTP 500 çš„é”™è¯¯è¯¦ç»†ä¿¡æ¯ï¼‰ã€‚è¿™æ ·çš„ JSON å°†è¢«è§£ç å¹¶è¿”å›ã€‚è¦æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸï¼Œè¯·ä½¿ç”¨ r.raise_for_status() æˆ–æ£€æŸ¥ r.status_code æ˜¯å¦ç¬¦åˆæ‚¨çš„é¢„æœŸã€‚</p><h2 id="åŸå§‹å“åº”å†…å®¹" tabindex="-1"><a class="header-anchor" href="#åŸå§‹å“åº”å†…å®¹" aria-hidden="true">#</a> åŸå§‹å“åº”å†…å®¹</h2><p>åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œæ‚¨æƒ³ä»æœåŠ¡å™¨è·å–åŸå§‹å¥—æ¥å­—å“åº”ï¼Œæ‚¨å¯ä»¥è®¿é—® r.rawã€‚å¦‚æœæ‚¨æƒ³è¿™æ ·åšï¼Œè¯·ç¡®ä¿åœ¨æ‚¨çš„åˆå§‹è¯·æ±‚ä¸­è®¾ç½® stream=Trueã€‚å®Œæˆåï¼Œæ‚¨å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r = requests.get(&#39;https://api.github.com/events&#39;, stream=True)

&gt;&gt;&gt; r.raw
&lt;urllib3.response.HTTPResponse object at 0x101194810&gt;

&gt;&gt;&gt; r.raw.read(10)
&#39;\x1f\x8b\x08\x00\x00\x00\x00\x00\x00\x03&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½†æ˜¯ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæ‚¨åº”è¯¥ä½¿ç”¨è¿™æ ·çš„æ¨¡å¼æ¥ä¿å­˜æ­£åœ¨æµå¼ä¼ è¾“åˆ°æ–‡ä»¶çš„å†…å®¹ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>with open(filename, &#39;wb&#39;) as fd:
    for chunk in r.iter_content(chunk_size=128):
        fd.write(chunk)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ Response.iter_content å°†å¤„ç†å¾ˆå¤šæ‚¨åœ¨ç›´æ¥ä½¿ç”¨ Response.raw æ—¶å¿…é¡»å¤„ç†çš„äº‹æƒ…ã€‚æµå¼ä¼ è¾“ä¸‹è½½æ—¶ï¼Œä»¥ä¸Šæ˜¯æ£€ç´¢å†…å®¹çš„é¦–é€‰å’Œæ¨èæ–¹å¼ã€‚è¯·æ³¨æ„ï¼Œchunk_size å¯ä»¥è‡ªç”±è°ƒæ•´ä¸ºæ›´é€‚åˆæ‚¨çš„ç”¨ä¾‹çš„æ•°å­—ã€‚</p><p>ç¬”è®°</p><p>å…³äºä½¿ç”¨ Response.iter_content ä¸ Response.raw çš„é‡è¦è¯´æ˜ã€‚ Response.iter_content å°†è‡ªåŠ¨è§£ç  gzip å’Œ deflate ä¼ è¾“ç¼–ç ã€‚ Response.raw æ˜¯ä¸€ä¸ªåŸå§‹çš„å­—èŠ‚æµâ€”â€”å®ƒä¸ä¼šè½¬æ¢å“åº”å†…å®¹ã€‚å¦‚æœæ‚¨ç¡®å®éœ€è¦è®¿é—®è¿”å›çš„å­—èŠ‚ï¼Œè¯·ä½¿ç”¨ Response.rawã€‚</p><h2 id="è‡ªå®šä¹‰header" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰header" aria-hidden="true">#</a> è‡ªå®šä¹‰Header</h2><p>å¦‚æœæ‚¨æƒ³å°† HTTP æ ‡å¤´æ·»åŠ åˆ°è¯·æ±‚ä¸­ï¼Œåªéœ€å°† dict ä¼ é€’ç»™ headers å‚æ•°ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬æ²¡æœ‰åœ¨å‰é¢çš„ä¾‹å­ä¸­æŒ‡å®šæˆ‘ä»¬çš„ç”¨æˆ·ä»£ç†ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>url = &#39;https://api.github.com/some/endpoint&#39;
headers = {&#39;user-agent&#39;: &#39;my-app/0.0.1&#39;}
r = requests.get(url, headers=headers)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šè‡ªå®šä¹‰æ ‡é¢˜çš„ä¼˜å…ˆçº§ä½äºæ›´å…·ä½“çš„ä¿¡æ¯æºã€‚ä¾‹å¦‚ï¼š</p><ul><li>å¦‚æœåœ¨ .netrc ä¸­æŒ‡å®šäº†å‡­æ®ï¼Œåˆ™ä½¿ç”¨ headers= è®¾ç½®çš„æˆæƒæ ‡å¤´å°†è¢«è¦†ç›–ï¼Œè€Œ .netrc åˆå°†è¢« auth= å‚æ•°è¦†ç›–ã€‚è¯·æ±‚å°†åœ¨ <sub>/.netrcã€</sub>/_netrc æˆ– NETRC ç¯å¢ƒå˜é‡æŒ‡å®šçš„è·¯å¾„ä¸­æœç´¢ netrc æ–‡ä»¶ã€‚</li><li>å¦‚æœæ‚¨è¢«é‡å®šå‘åˆ°ä¸»æœºå¤–ï¼Œæˆæƒæ ‡å¤´å°†è¢«åˆ é™¤ã€‚</li><li>Proxy-Authorization æ ‡å¤´å°†è¢« URL ä¸­æä¾›çš„ä»£ç†å‡­æ®è¦†ç›–ã€‚</li><li>å½“æˆ‘ä»¬å¯ä»¥ç¡®å®šå†…å®¹çš„é•¿åº¦æ—¶ï¼ŒContent-Length æ ‡å¤´å°†è¢«è¦†ç›–ã€‚</li></ul><p>æ­¤å¤–ï¼ŒRequests æ ¹æœ¬ä¸ä¼šæ ¹æ®æŒ‡å®šçš„è‡ªå®šä¹‰æ ‡å¤´æ›´æ”¹å…¶è¡Œä¸ºã€‚æ ‡å¤´åªæ˜¯ç®€å•åœ°ä¼ é€’åˆ°æœ€ç»ˆè¯·æ±‚ä¸­ã€‚</p><p>æ³¨æ„ï¼šæ‰€æœ‰æ ‡å¤´å€¼å¿…é¡»æ˜¯å­—ç¬¦ä¸²ã€å­—èŠ‚ä¸²æˆ– unicodeã€‚åœ¨å…è®¸çš„æƒ…å†µä¸‹ï¼Œå»ºè®®é¿å…ä¼ é€’ unicode æ ‡å¤´å€¼ã€‚</p><h2 id="æ›´å¤æ‚çš„-post-è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#æ›´å¤æ‚çš„-post-è¯·æ±‚" aria-hidden="true">#</a> æ›´å¤æ‚çš„ POST è¯·æ±‚</h2><p>é€šå¸¸ï¼Œæ‚¨å¸Œæœ›å‘é€ä¸€äº›è¡¨å•ç¼–ç çš„æ•°æ®â€”â€”å¾ˆåƒ HTML è¡¨å•ã€‚ä¸ºæ­¤ï¼Œåªéœ€å°†å­—å…¸ä¼ é€’ç»™ data å‚æ•°ã€‚å‘å‡ºè¯·æ±‚æ—¶ï¼Œæ‚¨çš„æ•°æ®å­—å…¸å°†è‡ªåŠ¨è¿›è¡Œè¡¨å•ç¼–ç ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>payload = {&#39;key1&#39;: &#39;value1&#39;, &#39;key2&#39;: &#39;value2&#39;}
r = requests.post(&quot;https://httpbin.org/post&quot;, data=payload)
print(r.text)
{
  ...
  &quot;form&quot;: {
    &quot;key2&quot;: &quot;value2&quot;,
    &quot;key1&quot;: &quot;value1&quot;
  },
  ...
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>data å‚æ•°ä¹Ÿå¯ä»¥ä¸ºæ¯ä¸ªé”®æœ‰å¤šä¸ªå€¼ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿æ•°æ®æˆä¸ºå…ƒç»„åˆ—è¡¨æˆ–ä»¥åˆ—è¡¨ä½œä¸ºå€¼çš„å­—å…¸æ¥å®Œæˆã€‚å½“è¡¨å•æœ‰å¤šä¸ªä½¿ç”¨ç›¸åŒé”®çš„å…ƒç´ æ—¶ï¼Œè¿™ç‰¹åˆ«æœ‰ç”¨ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; payload_tuples = [(&#39;key1&#39;, &#39;value1&#39;), (&#39;key1&#39;, &#39;value2&#39;)]
&gt;&gt;&gt; r1 = requests.post(&#39;https://httpbin.org/post&#39;, data=payload_tuples)
&gt;&gt;&gt; payload_dict = {&#39;key1&#39;: [&#39;value1&#39;, &#39;value2&#39;]}
&gt;&gt;&gt; r2 = requests.post(&#39;https://httpbin.org/post&#39;, data=payload_dict)
&gt;&gt;&gt; print(r1.text)
{
  ...
  &quot;form&quot;: {
    &quot;key1&quot;: [
      &quot;value1&quot;,
      &quot;value2&quot;
    ]
  },
  ...
}
&gt;&gt;&gt; r1.text == r2.text
True
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ‰æ—¶æ‚¨å¯èƒ½å¸Œæœ›å‘é€æœªè¿›è¡Œè¡¨å•ç¼–ç çš„æ•°æ®ã€‚å¦‚æœæ‚¨ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²è€Œä¸æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œåˆ™è¯¥æ•°æ®å°†ç›´æ¥å‘å¸ƒã€‚</p><p>ä¾‹å¦‚ï¼ŒGitHub API v3 æ¥å— JSON ç¼–ç çš„ POST/PATCH æ•°æ®ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; import json

&gt;&gt;&gt; url = &#39;https://api.github.com/some/endpoint&#39;
&gt;&gt;&gt; payload = {&#39;some&#39;: &#39;data&#39;}

&gt;&gt;&gt; r = requests.post(url, data=json.dumps(payload))
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œä¸Šé¢çš„ä»£ç ä¸ä¼šæ·»åŠ  Content-Type æ ‡å¤´ï¼ˆå› æ­¤ç‰¹åˆ«æ˜¯å®ƒä¸ä¼šå°†å…¶è®¾ç½®ä¸º application/jsonï¼‰ã€‚</p><p>å¦‚æœæ‚¨éœ€è¦è¯¥æ ‡å¤´é›†å¹¶ä¸”æ‚¨ä¸æƒ³è‡ªå·±å¯¹å­—å…¸è¿›è¡Œç¼–ç ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ json å‚æ•°ï¼ˆåœ¨ 2.4.2 ç‰ˆæœ¬ä¸­æ·»åŠ ï¼‰ç›´æ¥ä¼ é€’å®ƒï¼Œå®ƒå°†è‡ªåŠ¨ç¼–ç ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; url = &#39;https://api.github.com/some/endpoint&#39;
&gt;&gt;&gt; payload = {&#39;some&#39;: &#39;data&#39;}
&gt;&gt;&gt; r = requests.post(url, json=payload)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œå¦‚æœä¼ é€’æ•°æ®æˆ–æ–‡ä»¶ï¼Œåˆ™å¿½ç•¥ json å‚æ•°ã€‚</p><h2 id="å‘å¸ƒä¸€ä¸ªå¤šéƒ¨åˆ†ç¼–ç çš„æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#å‘å¸ƒä¸€ä¸ªå¤šéƒ¨åˆ†ç¼–ç çš„æ–‡ä»¶" aria-hidden="true">#</a> å‘å¸ƒä¸€ä¸ªå¤šéƒ¨åˆ†ç¼–ç çš„æ–‡ä»¶</h2><p>Requests è®©ä¸Šä¼ å¤šéƒ¨åˆ†ç¼–ç æ–‡ä»¶å˜å¾—ç®€å•ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; url = &#39;https://httpbin.org/post&#39;
&gt;&gt;&gt; files = {&#39;file&#39;: open(&#39;report.xls&#39;, &#39;rb&#39;)}

&gt;&gt;&gt; r = requests.post(url, files=files)
&gt;&gt;&gt; r.text
{
  ...
  &quot;files&quot;: {
    &quot;file&quot;: &quot;&lt;censored...binary...data&gt;&quot;
  },
  ...
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‚¨å¯ä»¥æ˜¾å¼è®¾ç½®æ–‡ä»¶åã€å†…å®¹ç±»å‹å’Œæ ‡é¢˜ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; url = &#39;https://httpbin.org/post&#39;
&gt;&gt;&gt; files = {&#39;file&#39;: (&#39;report.xls&#39;, open(&#39;report.xls&#39;, &#39;rb&#39;), &#39;application/vnd.ms-excel&#39;, {&#39;Expires&#39;: &#39;0&#39;})}

&gt;&gt;&gt; r = requests.post(url, files=files)
&gt;&gt;&gt; r.text
{
  ...
  &quot;files&quot;: {
    &quot;file&quot;: &quot;&lt;censored...binary...data&gt;&quot;
  },
  ...
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœéœ€è¦ï¼Œæ‚¨å¯ä»¥å‘é€è¦ä½œä¸ºæ–‡ä»¶æ¥æ”¶çš„å­—ç¬¦ä¸²ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; url = &#39;https://httpbin.org/post&#39;
&gt;&gt;&gt; files = {&#39;file&#39;: (&#39;report.csv&#39;, &#39;some,data,to,send\nanother,row,to,send\n&#39;)}

&gt;&gt;&gt; r = requests.post(url, files=files)
&gt;&gt;&gt; r.text
{
  ...
  &quot;files&quot;: {
    &quot;file&quot;: &quot;some,data,to,send\\nanother,row,to,send\\n&quot;
  },
  ...
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæ‚¨å°†ä¸€ä¸ªéå¸¸å¤§çš„æ–‡ä»¶ä½œä¸ºå¤šéƒ¨åˆ†/è¡¨å•æ•°æ®è¯·æ±‚å‘å¸ƒï¼Œæ‚¨å¯èƒ½éœ€è¦æµå¼ä¼ è¾“è¯·æ±‚ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œrequests ä¸æ”¯æŒæ­¤åŠŸèƒ½ï¼Œä½†æœ‰ä¸€ä¸ªå•ç‹¬çš„åŒ…æ”¯æŒ - requests-toolbeltã€‚æ‚¨åº”è¯¥é˜…è¯»å·¥å…·å¸¦çš„æ–‡æ¡£ä»¥è·å–æœ‰å…³å¦‚ä½•ä½¿ç”¨å®ƒçš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚</p><p>è¦åœ¨ä¸€ä¸ªè¯·æ±‚ä¸­å‘é€å¤šä¸ªæ–‡ä»¶ï¼Œè¯·å‚é˜…é«˜çº§éƒ¨åˆ†ã€‚</p><p>è­¦å‘Š</p><p>å¼ºçƒˆå»ºè®®æ‚¨ä»¥äºŒè¿›åˆ¶æ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚è¿™æ˜¯å› ä¸º Requests å¯èƒ½ä¼šå°è¯•ä¸ºæ‚¨æä¾› Content-Length æ ‡å¤´ï¼Œå¦‚æœè¿™æ ·åšï¼Œæ­¤å€¼å°†è®¾ç½®ä¸ºæ–‡ä»¶ä¸­çš„å­—èŠ‚æ•°ã€‚å¦‚æœä»¥æ–‡æœ¬æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå‡ºç°é”™è¯¯ã€‚</p><h2 id="å“åº”çŠ¶æ€ä»£ç " tabindex="-1"><a class="header-anchor" href="#å“åº”çŠ¶æ€ä»£ç " aria-hidden="true">#</a> å“åº”çŠ¶æ€ä»£ç </h2><p>æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹å“åº”çŠ¶æ€ç ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r = requests.get(&#39;https://httpbin.org/get&#39;)
&gt;&gt;&gt; r.status_code
200
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Requests è¿˜å¸¦æœ‰ä¸€ä¸ªå†…ç½®çš„çŠ¶æ€ç æŸ¥æ‰¾å¯¹è±¡ï¼Œä»¥ä¾¿äºå‚è€ƒï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r.status_code == requests.codes.ok
True
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæˆ‘ä»¬å‘å‡ºäº†é”™è¯¯çš„è¯·æ±‚ï¼ˆ4XX å®¢æˆ·ç«¯é”™è¯¯æˆ– 5XX æœåŠ¡å™¨é”™è¯¯å“åº”ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Response.raise_for_status() å¼•å‘å®ƒï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; bad_r = requests.get(&#39;https://httpbin.org/status/404&#39;)
&gt;&gt;&gt; bad_r.status_code
404

&gt;&gt;&gt; bad_r.raise_for_status()
Traceback (most recent call last):
  File &quot;requests/models.py&quot;, line 832, in raise_for_status
    raise http_error
requests.exceptions.HTTPError: 404 Client Error
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½†æ˜¯ï¼Œç”±äº r çš„ status_code æ˜¯ 200ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬è°ƒç”¨ raise_for_status() æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r.raise_for_status()
None
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸€åˆ‡éƒ½å¾ˆå¥½ã€‚</p><h2 id="å“åº”æ ‡å¤´" tabindex="-1"><a class="header-anchor" href="#å“åº”æ ‡å¤´" aria-hidden="true">#</a> å“åº”æ ‡å¤´</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Python å­—å…¸æŸ¥çœ‹æœåŠ¡å™¨çš„å“åº”å¤´ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r.headers
{
    &#39;content-encoding&#39;: &#39;gzip&#39;,
    &#39;transfer-encoding&#39;: &#39;chunked&#39;,
    &#39;connection&#39;: &#39;close&#39;,
    &#39;server&#39;: &#39;nginx/1.0.4&#39;,
    &#39;x-runtime&#39;: &#39;148ms&#39;,
    &#39;etag&#39;: &#39;&quot;e1ca502697e5c9317743dc078f67693f&quot;&#39;,
    &#39;content-type&#39;: &#39;application/json&#39;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸è¿‡ï¼Œå­—å…¸å¾ˆç‰¹åˆ«ï¼šå®ƒåªæ˜¯ä¸º HTTP æ ‡å¤´åˆ¶ä½œçš„ã€‚æ ¹æ® RFC 7230ï¼ŒHTTP æ ‡å¤´åç§°ä¸åŒºåˆ†å¤§å°å†™ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æˆ‘ä»¬æƒ³è¦çš„ä»»ä½•å¤§å°å†™æ¥è®¿é—®æ ‡é¢˜ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r.headers[&#39;Content-Type&#39;]
&#39;application/json&#39;

&gt;&gt;&gt; r.headers.get(&#39;content-type&#39;)
&#39;application/json&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ ¹æ® RFC 7230ï¼ŒæœåŠ¡å™¨å¯ä»¥å¤šæ¬¡å‘é€å…·æœ‰ä¸åŒå€¼çš„ç›¸åŒæ ‡å¤´ï¼Œä½†è¯·æ±‚å°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·ï¼Œå› æ­¤å®ƒä»¬å¯ä»¥åœ¨å•ä¸ªæ˜ å°„ä¸­çš„å­—å…¸ä¸­è¡¨ç¤ºï¼Œè¿™ä¹Ÿæ˜¯ç‰¹æ®Šçš„ï¼š</p><blockquote><p>æ¥æ”¶è€…å¯ä»¥å°†å…·æœ‰ç›¸åŒå­—æ®µåç§°çš„å¤šä¸ªå¤´å­—æ®µç»„åˆæˆä¸€ä¸ªâ€œå­—æ®µåç§°ï¼šå­—æ®µå€¼â€å¯¹ï¼Œè€Œä¸æ”¹å˜æ¶ˆæ¯çš„è¯­ä¹‰ï¼Œæ–¹æ³•æ˜¯å°†æ¯ä¸ªåç»­å­—æ®µå€¼æŒ‰é¡ºåºé™„åŠ åˆ°ç»„åˆçš„å­—æ®µå€¼ä¸Šï¼Œç”¨ a åˆ†éš”é€—å·ã€‚</p></blockquote><h2 id="cookies" tabindex="-1"><a class="header-anchor" href="#cookies" aria-hidden="true">#</a> Cookies</h2><p>å¦‚æœå“åº”åŒ…å«ä¸€äº› Cookieï¼Œæ‚¨å¯ä»¥å¿«é€Ÿè®¿é—®å®ƒä»¬ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; url = &#39;http://example.com/some/cookie/setting/url&#39;
&gt;&gt;&gt; r = requests.get(url)

&gt;&gt;&gt; r.cookies[&#39;example_cookie_name&#39;]
&#39;example_cookie_value&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦å°†è‡ªå·±çš„ cookie å‘é€åˆ°æœåŠ¡å™¨ï¼Œå¯ä»¥ä½¿ç”¨ cookies å‚æ•°ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; url = &#39;https://httpbin.org/cookies&#39;
&gt;&gt;&gt; cookies = dict(cookies_are=&#39;working&#39;)

&gt;&gt;&gt; r = requests.get(url, cookies=cookies)
&gt;&gt;&gt; r.text
&#39;{&quot;cookies&quot;: {&quot;cookies_are&quot;: &quot;working&quot;}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Cookies åœ¨ RequestsCookieJar ä¸­è¿”å›ï¼Œå®ƒçš„ä½œç”¨ç±»ä¼¼äº dictï¼Œä½†ä¹Ÿæä¾›äº†æ›´å®Œæ•´çš„æ¥å£ï¼Œé€‚åˆåœ¨å¤šä¸ªåŸŸæˆ–è·¯å¾„ä¸Šä½¿ç”¨ã€‚ Cookie jars ä¹Ÿå¯ä»¥ä¼ é€’ç»™è¯·æ±‚ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; jar = requests.cookies.RequestsCookieJar()
&gt;&gt;&gt; jar.set(&#39;tasty_cookie&#39;, &#39;yum&#39;, domain=&#39;httpbin.org&#39;, path=&#39;/cookies&#39;)
&gt;&gt;&gt; jar.set(&#39;gross_cookie&#39;, &#39;blech&#39;, domain=&#39;httpbin.org&#39;, path=&#39;/elsewhere&#39;)
&gt;&gt;&gt; url = &#39;https://httpbin.org/cookies&#39;
&gt;&gt;&gt; r = requests.get(url, cookies=jar)
&gt;&gt;&gt; r.text
&#39;{&quot;cookies&quot;: {&quot;tasty_cookie&quot;: &quot;yum&quot;}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="é‡å®šå‘å’Œå†å²" tabindex="-1"><a class="header-anchor" href="#é‡å®šå‘å’Œå†å²" aria-hidden="true">#</a> é‡å®šå‘å’Œå†å²</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯·æ±‚å°†å¯¹é™¤ HEAD ä¹‹å¤–çš„æ‰€æœ‰åŠ¨è¯æ‰§è¡Œä½ç½®é‡å®šå‘ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Response å¯¹è±¡çš„ history å±æ€§æ¥è·Ÿè¸ªé‡å®šå‘ã€‚</p><p>Response.history åˆ—è¡¨åŒ…å«ä¸ºå®Œæˆè¯·æ±‚è€Œåˆ›å»ºçš„ Response å¯¹è±¡ã€‚è¯¥åˆ—è¡¨æŒ‰ä»æœ€æ—©åˆ°æœ€è¿‘çš„å“åº”æ’åºã€‚</p><p>ä¾‹å¦‚ï¼ŒGitHub å°†æ‰€æœ‰ HTTP è¯·æ±‚é‡å®šå‘åˆ° HTTPSï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r = requests.get(&#39;http://github.com/&#39;)

&gt;&gt;&gt; r.url
&#39;https://github.com/&#39;

&gt;&gt;&gt; r.status_code
200

&gt;&gt;&gt; r.history
[&lt;Response [301]&gt;]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæ‚¨ä½¿ç”¨ GETã€OPTIONSã€POSTã€PUTã€PATCH æˆ– DELETEï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ allow_redirects å‚æ•°ç¦ç”¨é‡å®šå‘å¤„ç†ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r = requests.get(&#39;http://github.com/&#39;, allow_redirects=False)

&gt;&gt;&gt; r.status_code
301

&gt;&gt;&gt; r.history
[]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ ä½¿ç”¨ HEADï¼Œä½ ä¹Ÿå¯ä»¥å¯ç”¨é‡å®šå‘ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r = requests.head(&#39;http://github.com/&#39;, allow_redirects=True)

&gt;&gt;&gt; r.url
&#39;https://github.com/&#39;

&gt;&gt;&gt; r.history
[&lt;Response [301]&gt;]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="è¶…æ—¶" tabindex="-1"><a class="header-anchor" href="#è¶…æ—¶" aria-hidden="true">#</a> è¶…æ—¶</h2><p>æ‚¨å¯ä»¥ä½¿ç”¨ timeout å‚æ•°å‘Šè¯‰è¯·æ±‚åœ¨ç»™å®šçš„ç§’æ•°ååœæ­¢ç­‰å¾…å“åº”ã€‚å‡ ä¹æ‰€æœ‰ç”Ÿäº§ä»£ç éƒ½åº”åœ¨å‡ ä¹æ‰€æœ‰è¯·æ±‚ä¸­ä½¿ç”¨æ­¤å‚æ•°ã€‚ä¸è¿™æ ·åšå¯èƒ½ä¼šå¯¼è‡´æ‚¨çš„ç¨‹åºæ— é™æœŸæŒ‚èµ·ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; requests.get(&#39;https://github.com/&#39;, timeout=0.001)
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
requests.exceptions.Timeout: HTTPConnectionPool(host=&#39;github.com&#39;, port=80): Request timed out. (timeout=0.001)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¬”è®°</p><p>timeout ä¸æ˜¯æ•´ä¸ªå“åº”ä¸‹è½½çš„æ—¶é—´é™åˆ¶ï¼›ç›¸åï¼Œå¦‚æœæœåŠ¡å™¨åœ¨ timeout ç§’å†…æ²¡æœ‰å‘å‡ºå“åº”ï¼ˆæ›´å‡†ç¡®åœ°è¯´ï¼Œå¦‚æœåœ¨ timeout ç§’å†…åº•å±‚å¥—æ¥å­—ä¸Šæ²¡æœ‰æ”¶åˆ°ä»»ä½•å­—èŠ‚ï¼‰ï¼Œåˆ™ä¼šå¼•å‘å¼‚å¸¸ã€‚å¦‚æœæ²¡æœ‰æ˜ç¡®æŒ‡å®šè¶…æ—¶ï¼Œåˆ™è¯·æ±‚ä¸ä¼šè¶…æ—¶ã€‚</p><h2 id="é”™è¯¯å’Œå¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#é”™è¯¯å’Œå¼‚å¸¸" aria-hidden="true">#</a> é”™è¯¯å’Œå¼‚å¸¸</h2><p>å¦‚æœå‡ºç°ç½‘ç»œé—®é¢˜ï¼ˆä¾‹å¦‚ DNS æ•…éšœã€æ‹’ç»è¿æ¥ç­‰ï¼‰ï¼ŒRequests å°†å¼•å‘ ConnectionError å¼‚å¸¸ã€‚</p><p>å¦‚æœ HTTP è¯·æ±‚è¿”å›ä¸æˆåŠŸçš„çŠ¶æ€ä»£ç ï¼ŒResponse.raise_for_status() å°†å¼•å‘ HTTPErrorã€‚</p><p>å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œåˆ™ä¼šå¼•å‘è¶…æ—¶å¼‚å¸¸ã€‚</p><p>å¦‚æœè¯·æ±‚è¶…è¿‡é…ç½®çš„æœ€å¤§é‡å®šå‘æ•°ï¼Œåˆ™ä¼šå¼•å‘ TooManyRedirects å¼‚å¸¸ã€‚</p><p>Requests æ˜¾å¼å¼•å‘çš„æ‰€æœ‰å¼‚å¸¸éƒ½ç»§æ‰¿è‡ª requests.exceptions.RequestExceptionã€‚</p><h1 id="é«˜çº§ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#é«˜çº§ç”¨æ³•" aria-hidden="true">#</a> é«˜çº§ç”¨æ³•</h1><h2 id="ä¼šè¯å¯¹è±¡-session" tabindex="-1"><a class="header-anchor" href="#ä¼šè¯å¯¹è±¡-session" aria-hidden="true">#</a> ä¼šè¯å¯¹è±¡(Session)</h2><p>Session å¯¹è±¡å…è®¸æ‚¨è·¨è¯·æ±‚ä¿ç•™æŸäº›å‚æ•°ã€‚å®ƒè¿˜åœ¨ä¼šè¯å®ä¾‹å‘å‡ºçš„æ‰€æœ‰è¯·æ±‚ä¸­ä¿ç•™ cookieï¼Œå¹¶å°†ä½¿ç”¨ urllib3 çš„è¿æ¥æ± ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨å‘åŒä¸€ä¸»æœºå‘å‡ºå¤šä¸ªè¯·æ±‚ï¼Œåˆ™åº•å±‚ TCP è¿æ¥å°†è¢«é‡ç”¨ï¼Œè¿™å¯èƒ½ä¼šæ˜¾ç€æé«˜æ€§èƒ½ï¼ˆè¯·å‚é˜… HTTP æŒä¹…è¿æ¥ï¼‰ã€‚</p><p>Session å¯¹è±¡å…·æœ‰ä¸»è¯·æ±‚ API çš„æ‰€æœ‰æ–¹æ³•ã€‚</p><p>è®©æˆ‘ä»¬åœ¨è¯·æ±‚ä¸­ä¿ç•™ä¸€äº› cookieï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>s = requests.Session()

s.get(&#39;https://httpbin.org/cookies/set/sessioncookie/123456789&#39;)
r = s.get(&#39;https://httpbin.org/cookies&#39;)

print(r.text)
# &#39;{&quot;cookies&quot;: {&quot;sessioncookie&quot;: &quot;123456789&quot;}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¼šè¯ä¹Ÿå¯ç”¨äºå‘è¯·æ±‚æ–¹æ³•æä¾›é»˜è®¤æ•°æ®ã€‚è¿™æ˜¯é€šè¿‡å‘ Session å¯¹è±¡çš„å±æ€§æä¾›æ•°æ®æ¥å®Œæˆçš„ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>s = requests.Session()
s.auth = (&#39;user&#39;, &#39;pass&#39;)
s.headers.update({&#39;x-test&#39;: &#39;true&#39;})

# both &#39;x-test&#39; and &#39;x-test2&#39; are sent
s.get(&#39;https://httpbin.org/headers&#39;, headers={&#39;x-test2&#39;: &#39;true&#39;})
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‚¨ä¼ é€’ç»™è¯·æ±‚æ–¹æ³•çš„ä»»ä½•å­—å…¸éƒ½å°†ä¸è®¾ç½®çš„ä¼šè¯çº§å€¼åˆå¹¶ã€‚æ–¹æ³•çº§å‚æ•°è¦†ç›–ä¼šè¯å‚æ•°ã€‚</p><p>ä½†æ˜¯è¯·æ³¨æ„ï¼Œå³ä½¿ä½¿ç”¨ä¼šè¯ï¼Œæ–¹æ³•çº§å‚æ•°ä¹Ÿä¸ä¼šåœ¨è¯·æ±‚ä¹‹é—´ä¿æŒä¸å˜ã€‚æ­¤ç¤ºä¾‹å°†ä»…å‘é€å¸¦æœ‰ç¬¬ä¸€ä¸ªè¯·æ±‚çš„ cookieï¼Œè€Œä¸ä¼šå‘é€ç¬¬äºŒä¸ªè¯·æ±‚ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>s = requests.Session()

r = s.get(&#39;https://httpbin.org/cookies&#39;, cookies={&#39;from-my&#39;: &#39;browser&#39;})
print(r.text)
# &#39;{&quot;cookies&quot;: {&quot;from-my&quot;: &quot;browser&quot;}}&#39;

r = s.get(&#39;https://httpbin.org/cookies&#39;)
print(r.text)
# &#39;{&quot;cookies&quot;: {}}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæ‚¨æƒ³æ‰‹åŠ¨å°† cookie æ·»åŠ åˆ°ä¼šè¯ä¸­ï¼Œè¯·ä½¿ç”¨ Cookie å®ç”¨ç¨‹åºå‡½æ•°æ¥æ“ä½œ Session.cookiesã€‚</p><p>ä¼šè¯ä¹Ÿå¯ä»¥ç”¨ä½œä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>with requests.Session() as s:
    s.get(&#39;https://httpbin.org/cookies/set/sessioncookie/123456789&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™å°†ç¡®ä¿ä¼šè¯åœ¨é€€å‡º with å—åç«‹å³å…³é—­ï¼Œå³ä½¿å‘ç”Ÿæœªå¤„ç†çš„å¼‚å¸¸ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p><p>ä»å­—å…¸å‚æ•°ä¸­åˆ é™¤ä¸€ä¸ªå€¼</p><p>æœ‰æ—¶æ‚¨ä¼šå¸Œæœ›ä» dict å‚æ•°ä¸­çœç•¥ä¼šè¯çº§åˆ«çš„é”®ã€‚ä¸ºæ­¤ï¼Œæ‚¨åªéœ€åœ¨æ–¹æ³•çº§å‚æ•°ä¸­å°†è¯¥é”®çš„å€¼è®¾ç½®ä¸º Noneã€‚å®ƒä¼šè‡ªåŠ¨è¢«çœç•¥ã€‚</p><p>æ‚¨å¯ä»¥ç›´æ¥ä½¿ç”¨ä¼šè¯ä¸­åŒ…å«çš„æ‰€æœ‰å€¼ã€‚è¯·å‚é˜…ä¼šè¯ API æ–‡æ¡£ä»¥äº†è§£æ›´å¤šä¿¡æ¯ã€‚</p><h2 id="è¯·æ±‚å’Œå“åº”å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#è¯·æ±‚å’Œå“åº”å¯¹è±¡" aria-hidden="true">#</a> è¯·æ±‚å’Œå“åº”å¯¹è±¡</h2><p>æ¯å½“è°ƒç”¨ requests.get() å’Œæœ‹å‹æ—¶ï¼Œæ‚¨éƒ½åœ¨åšä¸¤ä»¶ä¸»è¦çš„äº‹æƒ…ã€‚é¦–å…ˆï¼Œæ‚¨æ­£åœ¨æ„å»ºä¸€ä¸ª Request å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°†è¢«å‘é€åˆ°æœåŠ¡å™¨ä»¥è¯·æ±‚æˆ–æŸ¥è¯¢æŸäº›èµ„æºã€‚å…¶æ¬¡ï¼Œä¸€æ—¦ Requests ä»æœåŠ¡å™¨è·å¾—å“åº”ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ª Response å¯¹è±¡ã€‚ Response å¯¹è±¡åŒ…å«æœåŠ¡å™¨è¿”å›çš„æ‰€æœ‰ä¿¡æ¯ï¼Œè¿˜åŒ…å«æ‚¨æœ€åˆåˆ›å»ºçš„ Request å¯¹è±¡ã€‚è¿™æ˜¯ä¸€ä¸ªä» Wikipedia çš„æœåŠ¡å™¨è·å–ä¸€äº›éå¸¸é‡è¦çš„ä¿¡æ¯çš„ç®€å•è¯·æ±‚ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r = requests.get(&#39;https://en.wikipedia.org/wiki/Monty_Python&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¦‚æœæˆ‘ä»¬æƒ³è®¿é—®æœåŠ¡å™¨å‘å›ç»™æˆ‘ä»¬çš„æ ‡å¤´ï¼Œæˆ‘ä»¬è¿™æ ·åšï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r.headers
{&#39;content-length&#39;: &#39;56170&#39;, &#39;x-content-type-options&#39;: &#39;nosniff&#39;, &#39;x-cache&#39;:
&#39;HIT from cp1006.eqiad.wmnet, MISS from cp1010.eqiad.wmnet&#39;, &#39;content-encoding&#39;:
&#39;gzip&#39;, &#39;age&#39;: &#39;3080&#39;, &#39;content-language&#39;: &#39;en&#39;, &#39;vary&#39;: &#39;Accept-Encoding,Cookie&#39;,
&#39;server&#39;: &#39;Apache&#39;, &#39;last-modified&#39;: &#39;Wed, 13 Jun 2012 01:33:50 GMT&#39;,
&#39;connection&#39;: &#39;close&#39;, &#39;cache-control&#39;: &#39;private, s-maxage=0, max-age=0,
must-revalidate&#39;, &#39;date&#39;: &#39;Thu, 14 Jun 2012 12:59:39 GMT&#39;, &#39;content-type&#39;:
&#39;text/html; charset=UTF-8&#39;, &#39;x-cache-lookup&#39;: &#39;HIT from cp1006.eqiad.wmnet:3128,
MISS from cp1010.eqiad.wmnet:80&#39;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è·å–æˆ‘ä»¬å‘é€ç»™æœåŠ¡å™¨çš„æ ‡å¤´ï¼Œæˆ‘ä»¬åªéœ€è®¿é—®è¯·æ±‚ï¼Œç„¶åè®¿é—®è¯·æ±‚çš„æ ‡å¤´ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r.request.headers
{&#39;Accept-Encoding&#39;: &#39;identity, deflate, compress, gzip&#39;,
&#39;Accept&#39;: &#39;*/*&#39;, &#39;User-Agent&#39;: &#39;python-requests/1.2.0&#39;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å‡†å¤‡å¥½çš„è¯·æ±‚-apiç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å‡†å¤‡å¥½çš„è¯·æ±‚-apiç¤ºä¾‹" aria-hidden="true">#</a> å‡†å¤‡å¥½çš„è¯·æ±‚(APIç¤ºä¾‹)</h2><p>æ¯å½“æ‚¨ä» API è°ƒç”¨æˆ– Session è°ƒç”¨æ¥æ”¶åˆ° Response å¯¹è±¡æ—¶ï¼Œè¯·æ±‚å±æ€§å®é™…ä¸Šå°±æ˜¯ä½¿ç”¨çš„ PreparedRequestã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½å¸Œæœ›åœ¨å‘é€è¯·æ±‚ä¹‹å‰å¯¹æ­£æ–‡æˆ–æ ‡å¤´ï¼ˆæˆ–å…¶ä»–ä»»ä½•ä¸œè¥¿ï¼‰åšä¸€äº›é¢å¤–çš„å·¥ä½œã€‚ç®€å•çš„é…æ–¹å¦‚ä¸‹ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>from requests import Request, Session

s = Session()

req = Request(&#39;POST&#39;, url, data=data, headers=headers)
prepped = req.prepare()

# do something with prepped.body
prepped.body = &#39;No, I want exactly this as the body.&#39;

# do something with prepped.headers
del prepped.headers[&#39;Content-Type&#39;]

resp = s.send(prepped,
    stream=stream,
    verify=verify,
    proxies=proxies,
    cert=cert,
    timeout=timeout
)

print(resp.status_code)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”±äºæ‚¨æ²¡æœ‰å¯¹ Request å¯¹è±¡åšä»»ä½•ç‰¹åˆ«çš„äº‹æƒ…ï¼Œå› æ­¤æ‚¨ç«‹å³å‡†å¤‡å®ƒå¹¶ä¿®æ”¹ PreparedRequest å¯¹è±¡ã€‚ç„¶åï¼Œæ‚¨å°†å…¶ä¸æ‚¨å°†å‘é€åˆ° requests.* æˆ– Session.* çš„å…¶ä»–å‚æ•°ä¸€èµ·å‘é€ã€‚</p><p>ä½†æ˜¯ï¼Œä¸Šé¢çš„ä»£ç å°†å¤±å»æ‹¥æœ‰ Requests Session å¯¹è±¡çš„ä¸€äº›ä¼˜ç‚¹ã€‚ç‰¹åˆ«æ˜¯ï¼Œä¼šè¯çº§çŠ¶æ€ï¼ˆä¾‹å¦‚ cookieï¼‰ä¸ä¼šåº”ç”¨äºæ‚¨çš„è¯·æ±‚ã€‚è¦è·å¾—åº”ç”¨äº†è¯¥çŠ¶æ€çš„ PreparedRequestï¼Œè¯·å°†å¯¹ Request.prepare() çš„è°ƒç”¨æ›¿æ¢ä¸ºå¯¹ Session.prepare_request() çš„è°ƒç”¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>from requests import Request, Session

s = Session()
req = Request(&#39;GET&#39;,  url, data=data, headers=headers)

prepped = s.prepare_request(req)

# do something with prepped.body
prepped.body = &#39;Seriously, send exactly these bytes.&#39;

# do something with prepped.headers
prepped.headers[&#39;Keep-Dead&#39;] = &#39;parrot&#39;

resp = s.send(prepped,
    stream=stream,
    verify=verify,
    proxies=proxies,
    cert=cert,
    timeout=timeout
)

print(resp.status_code)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“æ‚¨ä½¿ç”¨å‡†å¤‡å¥½çš„è¯·æ±‚æµæ—¶ï¼Œè¯·è®°ä½å®ƒæ²¡æœ‰è€ƒè™‘ç¯å¢ƒã€‚å¦‚æœæ‚¨ä½¿ç”¨ç¯å¢ƒå˜é‡æ¥æ›´æ”¹è¯·æ±‚çš„è¡Œä¸ºï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ã€‚ä¾‹å¦‚ï¼š REQUESTS_CA_BUNDLE ä¸­æŒ‡å®šçš„è‡ªç­¾å SSL è¯ä¹¦å°†ä¸äºˆè€ƒè™‘ã€‚ç»“æœæ˜¯ SSL: CERTIFICATE_VERIFY_FAILED è¢«æŠ›å‡ºã€‚æ‚¨å¯ä»¥é€šè¿‡å°†ç¯å¢ƒè®¾ç½®æ˜¾å¼åˆå¹¶åˆ°ä¼šè¯ä¸­æ¥è§£å†³æ­¤é—®é¢˜ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>from requests import Request, Session

s = Session()
req = Request(&#39;GET&#39;, url)

prepped = s.prepare_request(req)

# Merge environment settings into session
settings = s.merge_environment_settings(prepped.url, {}, None, None, None)
resp = s.send(prepped, **settings)

print(resp.status_code)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ssl-è¯ä¹¦éªŒè¯" tabindex="-1"><a class="header-anchor" href="#ssl-è¯ä¹¦éªŒè¯" aria-hidden="true">#</a> SSL è¯ä¹¦éªŒè¯</h2><p>Requests ä¸º HTTPS è¯·æ±‚éªŒè¯ SSL è¯ä¹¦ï¼Œå°±åƒ Web æµè§ˆå™¨ä¸€æ ·ã€‚é»˜è®¤æƒ…å†µä¸‹å¯ç”¨ SSL éªŒè¯ï¼Œå¦‚æœæ— æ³•éªŒè¯è¯ä¹¦ï¼ŒRequests å°†æŠ›å‡º SSLErrorï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; requests.get(&#39;https://requestb.in&#39;)
requests.exceptions.SSLError: hostname &#39;requestb.in&#39; doesn&#39;t match either of &#39;*.herokuapp.com&#39;, &#39;herokuapp.com&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘æ²¡æœ‰åœ¨è¿™ä¸ªåŸŸä¸Šè®¾ç½® SSLï¼Œæ‰€ä»¥å®ƒä¼šå¼•å‘å¼‚å¸¸ã€‚å‡ºè‰²çš„ã€‚ GitHub ç¡®å®ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; requests.get(&#39;https://github.com&#39;)
&lt;Response [200]&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‚¨å¯ä»¥é€šè¿‡å—ä¿¡ä»»çš„ CA è¯ä¹¦éªŒè¯ CA_BUNDLE æ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; requests.get(&#39;https://github.com&#39;, verify=&#39;/path/to/certfile&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æˆ–æŒä¹…çš„ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>s = requests.Session()
s.verify = &#39;/path/to/certfile&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¬”è®°</p><p>å¦‚æœ verify è®¾ç½®ä¸ºç›®å½•çš„è·¯å¾„ï¼Œåˆ™å¿…é¡»ä½¿ç”¨ OpenSSL æä¾›çš„ c_rehash å®ç”¨ç¨‹åºå¤„ç†è¯¥ç›®å½•ã€‚</p><p>è¿™ä¸ªå—ä¿¡ä»»çš„ CA åˆ—è¡¨ä¹Ÿå¯ä»¥é€šè¿‡ REQUESTS_CA_BUNDLE ç¯å¢ƒå˜é‡æŒ‡å®šã€‚å¦‚æœæœªè®¾ç½® REQUESTS_CA_BUNDLEï¼Œåˆ™ CURL_CA_BUNDLE å°†ç”¨ä½œåå¤‡ã€‚</p><p>å¦‚æœå°† verify è®¾ç½®ä¸º Falseï¼Œè¯·æ±‚ä¹Ÿå¯ä»¥å¿½ç•¥éªŒè¯ SSL è¯ä¹¦ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; requests.get(&#39;https://kennethreitz.org&#39;, verify=False)
&lt;Response [200]&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œå½“ verify è®¾ç½®ä¸º False æ—¶ï¼Œè¯·æ±‚å°†æ¥å—æœåŠ¡å™¨æä¾›çš„ä»»ä½• TLS è¯ä¹¦ï¼Œå¹¶å°†å¿½ç•¥ä¸»æœºåä¸åŒ¹é…å’Œ/æˆ–è¿‡æœŸè¯ä¹¦ï¼Œè¿™å°†ä½¿æ‚¨çš„åº”ç”¨ç¨‹åºå®¹æ˜“å—åˆ°ä¸­é—´äºº (MitM) æ”»å‡»ã€‚åœ¨æœ¬åœ°å¼€å‘æˆ–æµ‹è¯•æœŸé—´ï¼Œå°† verify è®¾ç½®ä¸º False å¯èƒ½å¾ˆæœ‰ç”¨ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒéªŒè¯è®¾ç½®ä¸º Trueã€‚é€‰é¡¹ verify ä»…é€‚ç”¨äºä¸»æœºè¯ä¹¦ã€‚</p><h2 id="å®¢æˆ·ç«¯è¯ä¹¦" tabindex="-1"><a class="header-anchor" href="#å®¢æˆ·ç«¯è¯ä¹¦" aria-hidden="true">#</a> å®¢æˆ·ç«¯è¯ä¹¦</h2><p>æ‚¨è¿˜å¯ä»¥æŒ‡å®šæœ¬åœ°è¯ä¹¦ç”¨ä½œå®¢æˆ·ç«¯è¯ä¹¦ï¼Œä½œä¸ºå•ä¸ªæ–‡ä»¶ï¼ˆåŒ…å«ç§é’¥å’Œè¯ä¹¦ï¼‰æˆ–ä½œä¸ºä¸¤ä¸ªæ–‡ä»¶è·¯å¾„çš„å…ƒç»„ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; requests.get(&#39;https://kennethreitz.org&#39;, cert=(&#39;/path/client.cert&#39;, &#39;/path/client.key&#39;))
&lt;Response [200]&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–æŒä¹…çš„ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>s = requests.Session()
s.cert = &#39;/path/client.cert&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæ‚¨æŒ‡å®šäº†é”™è¯¯çš„è·¯å¾„æˆ–æ— æ•ˆçš„è¯ä¹¦ï¼Œæ‚¨å°†æ”¶åˆ° SSLErrorï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; requests.get(&#39;https://kennethreitz.org&#39;, cert=&#39;/wrong_path/client.pem&#39;)
SSLError: [Errno 336265225] _ssl.c:347: error:140B0009:SSL routines:SSL_CTX_use_PrivateKey_file:PEM lib
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è­¦å‘Š</p><p>æœ¬åœ°è¯ä¹¦çš„ç§é’¥å¿…é¡»æœªåŠ å¯†ã€‚ç›®å‰ï¼ŒRequests ä¸æ”¯æŒä½¿ç”¨åŠ å¯†å¯†é’¥ã€‚</p><h2 id="ca-è¯ä¹¦" tabindex="-1"><a class="header-anchor" href="#ca-è¯ä¹¦" aria-hidden="true">#</a> CA è¯ä¹¦</h2><p>Requests ä½¿ç”¨åŒ… certifi ä¸­çš„è¯ä¹¦ã€‚è¿™å…è®¸ç”¨æˆ·åœ¨ä¸æ›´æ”¹è¯·æ±‚ç‰ˆæœ¬çš„æƒ…å†µä¸‹æ›´æ–°å…¶å—ä¿¡ä»»çš„è¯ä¹¦ã€‚</p><p>åœ¨ 2.16 ç‰ˆä¹‹å‰ï¼ŒRequests æ†ç»‘äº†ä¸€ç»„å®ƒä¿¡ä»»çš„æ ¹ CAï¼Œè¿™äº› CA æ¥è‡ª Mozilla ä¿¡ä»»åº“ã€‚æ¯ä¸ªè¯·æ±‚ç‰ˆæœ¬çš„è¯ä¹¦ä»…æ›´æ–°ä¸€æ¬¡ã€‚å¦‚æœæœªå®‰è£… certifiï¼Œåˆ™åœ¨ä½¿ç”¨æ˜æ˜¾è¾ƒæ—§ç‰ˆæœ¬çš„ Requests æ—¶ï¼Œè¿™ä¼šå¯¼è‡´è¯ä¹¦åŒ…éå¸¸è¿‡æ—¶ã€‚</p><p>ä¸ºäº†å®‰å…¨èµ·è§ï¼Œæˆ‘ä»¬å»ºè®®ç»å¸¸å‡çº§è¯ä¹¦ï¼</p><h2 id="æ­£æ–‡å†…å®¹å·¥ä½œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#æ­£æ–‡å†…å®¹å·¥ä½œæµç¨‹" aria-hidden="true">#</a> æ­£æ–‡å†…å®¹å·¥ä½œæµç¨‹</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“æ‚¨å‘å‡ºè¯·æ±‚æ—¶ï¼Œä¼šç«‹å³ä¸‹è½½å“åº”çš„æ­£æ–‡ã€‚æ‚¨å¯ä»¥è¦†ç›–æ­¤è¡Œä¸ºå¹¶æ¨è¿Ÿä¸‹è½½å“åº”æ­£æ–‡ï¼Œç›´åˆ°æ‚¨ä½¿ç”¨æµå‚æ•°è®¿é—® Response.content å±æ€§ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>tarball_url = &#39;https://github.com/psf/requests/tarball/main&#39;
r = requests.get(tarball_url, stream=True)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶åªä¸‹è½½äº†å“åº”æ ‡å¤´å¹¶ä¸”è¿æ¥ä¿æŒæ‰“å¼€çŠ¶æ€ï¼Œå› æ­¤å…è®¸æˆ‘ä»¬ä½¿å†…å®¹æ£€ç´¢æœ‰æ¡ä»¶ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>if int(r.headers[&#39;content-length&#39;]) &lt; TOO_LONG:
  content = r.content
  ...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‚¨å¯ä»¥ä½¿ç”¨ Response.iter_content() å’Œ Response.iter_lines() æ–¹æ³•è¿›ä¸€æ­¥æ§åˆ¶å·¥ä½œæµç¨‹ã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä» Response.raw çš„åº•å±‚ urllib3 urllib3.HTTPResponse è¯»å–æœªè§£ç çš„æ­£æ–‡ã€‚</p><p>å¦‚æœæ‚¨åœ¨å‘å‡ºè¯·æ±‚æ—¶å°†æµè®¾ç½®ä¸º Trueï¼Œåˆ™é™¤éæ‚¨æ¶ˆè€—æ‰€æœ‰æ•°æ®æˆ–è°ƒç”¨ Response.closeï¼Œå¦åˆ™ Requests æ— æ³•å°†è¿æ¥é‡Šæ”¾å›æ± ä¸­ã€‚è¿™å¯èƒ½å¯¼è‡´è¿æ¥æ•ˆç‡ä½ä¸‹ã€‚å¦‚æœæ‚¨å‘ç°è‡ªå·±åœ¨ä½¿ç”¨ stream=True æ—¶éƒ¨åˆ†è¯»å–äº†è¯·æ±‚æ­£æ–‡ï¼ˆæˆ–æ ¹æœ¬ä¸è¯»å–å®ƒä»¬ï¼‰ï¼Œæ‚¨åº”è¯¥åœ¨ with è¯­å¥ä¸­å‘å‡ºè¯·æ±‚ä»¥ç¡®ä¿å®ƒå§‹ç»ˆå…³é—­ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>with requests.get(&#39;https://httpbin.org/get&#39;, stream=True) as r:
    # Do things with the response here.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æ´»ç€-belive" tabindex="-1"><a class="header-anchor" href="#æ´»ç€-belive" aria-hidden="true">#</a> æ´»ç€(Belive)</h2><p>å¥½æ¶ˆæ¯â€”â€”æ„Ÿè°¢ urllib3ï¼Œåœ¨ä¼šè¯ä¸­ä¿æŒæ´»åŠ¨æ˜¯ 100% è‡ªåŠ¨çš„ï¼æ‚¨åœ¨ä¼šè¯ä¸­å‘å‡ºçš„ä»»ä½•è¯·æ±‚éƒ½å°†è‡ªåŠ¨é‡ç”¨ç›¸åº”çš„è¿æ¥ï¼</p><p>è¯·æ³¨æ„ï¼Œåªæœ‰åœ¨è¯»å–æ‰€æœ‰ä¸»ä½“æ•°æ®åï¼Œè¿æ¥æ‰ä¼šé‡Šæ”¾å›æ± ä¸­ä»¥ä¾›é‡ç”¨ï¼›è¯·åŠ¡å¿…å°† stream è®¾ç½®ä¸º False æˆ–è¯»å– Response å¯¹è±¡çš„ content å±æ€§ã€‚</p><h2 id="æµå¼ä¸Šä¼ -upload" tabindex="-1"><a class="header-anchor" href="#æµå¼ä¸Šä¼ -upload" aria-hidden="true">#</a> æµå¼ä¸Šä¼ (Upload)</h2><p>Requests æ”¯æŒæµå¼ä¸Šä¼ ï¼Œå…è®¸æ‚¨å‘é€å¤§å‹æµæˆ–æ–‡ä»¶è€Œæ— éœ€å°†å®ƒä»¬è¯»å…¥å†…å­˜ã€‚è¦æµå¼ä¼ è¾“å’Œä¸Šä¼ ï¼Œåªéœ€ä¸ºæ‚¨çš„ body æä¾›ä¸€ä¸ªç±»ä¼¼æ–‡ä»¶çš„å¯¹è±¡ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>with open(&#39;massive-body&#39;, &#39;rb&#39;) as f:
    requests.post(&#39;http://some.url/streamed&#39;, data=f)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è­¦å‘Š</p><p>å¼ºçƒˆå»ºè®®æ‚¨ä»¥äºŒè¿›åˆ¶æ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚è¿™æ˜¯å› ä¸º Requests å¯èƒ½ä¼šå°è¯•ä¸ºæ‚¨æä¾› Content-Length æ ‡å¤´ï¼Œå¦‚æœè¿™æ ·åšï¼Œæ­¤å€¼å°†è®¾ç½®ä¸ºæ–‡ä»¶ä¸­çš„å­—èŠ‚æ•°ã€‚å¦‚æœä»¥æ–‡æœ¬æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå‡ºç°é”™è¯¯ã€‚</p><h2 id="å—ç¼–ç è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#å—ç¼–ç è¯·æ±‚" aria-hidden="true">#</a> å—ç¼–ç è¯·æ±‚</h2><p>Requests è¿˜æ”¯æŒä¼ å‡ºå’Œä¼ å…¥è¯·æ±‚çš„åˆ†å—ä¼ è¾“ç¼–ç ã€‚è¦å‘é€å—ç¼–ç çš„è¯·æ±‚ï¼Œåªéœ€ä¸ºæ‚¨çš„ä¸»ä½“æä¾›ä¸€ä¸ªç”Ÿæˆå™¨ï¼ˆæˆ–ä»»ä½•æ²¡æœ‰é•¿åº¦çš„è¿­ä»£å™¨ï¼‰ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>def gen():
    yield &#39;hi&#39;
    yield &#39;there&#39;

requests.post(&#39;http://some.url/chunked&#39;, data=gen())
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹äºåˆ†å—ç¼–ç çš„å“åº”ï¼Œæœ€å¥½ä½¿ç”¨ Response.iter_content() éå†æ•°æ®ã€‚åœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œæ‚¨å°†åœ¨è¯·æ±‚ä¸­è®¾ç½® stream=Trueï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥é€šè¿‡è°ƒç”¨ iter_content å¹¶ä½¿ç”¨ chunk_size å‚æ•° None æ¥é€å—è¿­ä»£ã€‚å¦‚æœè¦è®¾ç½®å—çš„æœ€å¤§å¤§å°ï¼Œå¯ä»¥å°† chunk_size å‚æ•°è®¾ç½®ä¸ºä»»æ„æ•´æ•°ã€‚</p><h2 id="post-å¤šä¸ªå¤šéƒ¨åˆ†ç¼–ç æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#post-å¤šä¸ªå¤šéƒ¨åˆ†ç¼–ç æ–‡ä»¶" aria-hidden="true">#</a> POST å¤šä¸ªå¤šéƒ¨åˆ†ç¼–ç æ–‡ä»¶</h2><p>æ‚¨å¯ä»¥åœ¨ä¸€ä¸ªè¯·æ±‚ä¸­å‘é€å¤šä¸ªæ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨è¦å°†å›¾åƒæ–‡ä»¶ä¸Šä¼ åˆ°å…·æœ‰å¤šä¸ªæ–‡ä»¶å­—æ®µâ€œå›¾åƒâ€çš„ HTML è¡¨å•ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;input type=&quot;file&quot; name=&quot;images&quot; multiple=&quot;true&quot; required=&quot;true&quot;/&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¸ºæ­¤ï¼Œåªéœ€å°†æ–‡ä»¶è®¾ç½®ä¸º (form_field_name, file_info) çš„å…ƒç»„åˆ—è¡¨ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; url = &#39;https://httpbin.org/post&#39;
&gt;&gt;&gt; multiple_files = [
...     (&#39;images&#39;, (&#39;foo.png&#39;, open(&#39;foo.png&#39;, &#39;rb&#39;), &#39;image/png&#39;)),
...     (&#39;images&#39;, (&#39;bar.png&#39;, open(&#39;bar.png&#39;, &#39;rb&#39;), &#39;image/png&#39;))]
&gt;&gt;&gt; r = requests.post(url, files=multiple_files)
&gt;&gt;&gt; r.text
{
  ...
  &#39;files&#39;: {&#39;images&#39;: &#39;data:image/png;base64,iVBORw ....&#39;}
  &#39;Content-Type&#39;: &#39;multipart/form-data; boundary=3131623adb2043caaeb5538cc7aa0b3a&#39;,
  ...
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è­¦å‘Š</p><p>å¼ºçƒˆå»ºè®®æ‚¨ä»¥äºŒè¿›åˆ¶æ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚è¿™æ˜¯å› ä¸º Requests å¯èƒ½ä¼šå°è¯•ä¸ºæ‚¨æä¾› Content-Length æ ‡å¤´ï¼Œå¦‚æœè¿™æ ·åšï¼Œæ­¤å€¼å°†è®¾ç½®ä¸ºæ–‡ä»¶ä¸­çš„å­—èŠ‚æ•°ã€‚å¦‚æœä»¥æ–‡æœ¬æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå‡ºç°é”™è¯¯ã€‚</p><h2 id="äº‹ä»¶æŒ‚é’©" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶æŒ‚é’©" aria-hidden="true">#</a> äº‹ä»¶æŒ‚é’©</h2><p>Requests æœ‰ä¸€ä¸ªé’©å­ç³»ç»Ÿï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥æ“çºµè¯·æ±‚è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†æˆ–ä¿¡å·äº‹ä»¶å¤„ç†ã€‚</p><p>å¯ç”¨çš„é’©å­ï¼š</p><ul><li><p>å›å¤ï¼š</p><p>ä»è¯·æ±‚ç”Ÿæˆçš„å“åº”ã€‚</p></li></ul><p>æ‚¨å¯ä»¥é€šè¿‡å°† {hook_name: callback_function} å­—å…¸ä¼ é€’ç»™ hooks è¯·æ±‚å‚æ•°æ¥ä¸ºæ¯ä¸ªè¯·æ±‚åˆ†é…ä¸€ä¸ªé’©å­å‡½æ•°ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>hooks={&#39;response&#39;: print_url}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¯¥å›è°ƒå‡½æ•°å°†æ¥æ”¶ä¸€å¤§å—æ•°æ®ä½œä¸ºå…¶ç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>def print_url(r, *args, **kwargs):
    print(r.url)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‚¨çš„å›è°ƒå‡½æ•°å¿…é¡»å¤„ç†è‡ªå·±çš„å¼‚å¸¸ã€‚ä»»ä½•æœªå¤„ç†çš„å¼‚å¸¸éƒ½ä¸ä¼šé™é»˜ä¼ é€’ï¼Œå› æ­¤åº”ç”±è°ƒç”¨ Requests çš„ä»£ç å¤„ç†ã€‚</p><p>å¦‚æœå›è°ƒå‡½æ•°è¿”å›ä¸€ä¸ªå€¼ï¼Œåˆ™å‡å®šå®ƒæ˜¯æ›¿æ¢ä¼ å…¥çš„æ•°æ®ã€‚å¦‚æœè¯¥å‡½æ•°æ²¡æœ‰è¿”å›ä»»ä½•å†…å®¹ï¼Œåˆ™ä¸ä¼šå½±å“å…¶ä»–ä»»ä½•å†…å®¹ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>def record_hook(r, *args, **kwargs):
    r.hook_called = True
    return r
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è®©æˆ‘ä»¬åœ¨è¿è¡Œæ—¶æ‰“å°ä¸€äº›è¯·æ±‚æ–¹æ³•å‚æ•°ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; requests.get(&#39;https://httpbin.org/&#39;, hooks={&#39;response&#39;: print_url})
https://httpbin.org/
&lt;Response [200]&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‚¨å¯ä»¥å‘å•ä¸ªè¯·æ±‚æ·»åŠ å¤šä¸ªæŒ‚é’©ã€‚è®©æˆ‘ä»¬ä¸€æ¬¡è°ƒç”¨ä¸¤ä¸ªé’©å­ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r = requests.get(&#39;https://httpbin.org/&#39;, hooks={&#39;response&#39;: [print_url, record_hook]})
&gt;&gt;&gt; r.hook_called
True
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‚¨è¿˜å¯ä»¥å°†æŒ‚é’©æ·»åŠ åˆ° Session å®ä¾‹ã€‚ç„¶åï¼Œæ‚¨æ·»åŠ çš„ä»»ä½•é’©å­éƒ½å°†åœ¨å¯¹ä¼šè¯å‘å‡ºçš„æ¯ä¸ªè¯·æ±‚ä¸Šè¢«è°ƒç”¨ã€‚ä¾‹å¦‚ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; s = requests.Session()
&gt;&gt;&gt; s.hooks[&#39;response&#39;].append(print_url)
&gt;&gt;&gt; s.get(&#39;https://httpbin.org/&#39;)
 https://httpbin.org/
 &lt;Response [200]&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸€ä¸ª Session å¯ä»¥æœ‰å¤šä¸ªé’©å­ï¼Œå®ƒä»¬ä¼šæŒ‰ç…§æ·»åŠ çš„é¡ºåºè¢«è°ƒç”¨ã€‚</p><h2 id="è‡ªå®šä¹‰èº«ä»½éªŒè¯" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰èº«ä»½éªŒè¯" aria-hidden="true">#</a> è‡ªå®šä¹‰èº«ä»½éªŒè¯</h2><p>Requests å…è®¸æ‚¨æŒ‡å®šè‡ªå·±çš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚</p><p>ä»»ä½•ä½œä¸º auth å‚æ•°ä¼ é€’ç»™è¯·æ±‚æ–¹æ³•çš„å¯è°ƒç”¨å¯¹è±¡éƒ½å°†æœ‰æœºä¼šåœ¨è¯·æ±‚è¢«åˆ†æ´¾ä¹‹å‰å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚</p><p>èº«ä»½éªŒè¯å®ç°æ˜¯ AuthBase çš„å­ç±»ï¼Œå¹¶ä¸”æ˜“äºå®šä¹‰ã€‚ Requests åœ¨ requests.auth ä¸­æä¾›äº†ä¸¤ç§å¸¸è§çš„èº«ä»½éªŒè¯æ–¹æ¡ˆå®ç°ï¼šHTTPBasicAuth å’Œ HTTPDigestAuthã€‚</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª Web æœåŠ¡ï¼Œåªæœ‰åœ¨ X-Pizza æ ‡å¤´è®¾ç½®ä¸ºå¯†ç å€¼æ—¶æ‰ä¼šå“åº”ã€‚ä¸å¤ªå¯èƒ½ï¼Œä½†éšå®ƒå»å§ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>from requests.auth import AuthBase

class PizzaAuth(AuthBase):
    &quot;&quot;&quot;Attaches HTTP Pizza Authentication to the given Request object.&quot;&quot;&quot;
    def __init__(self, username):
        # setup any auth-related data here
        self.username = username

    def __call__(self, r):
        # modify and return the request
        r.headers[&#39;X-Pizza&#39;] = self.username
        return r
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„ Pizza Auth å‘å‡ºè¯·æ±‚ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; requests.get(&#39;http://pizzabin.org/admin&#39;, auth=PizzaAuth(&#39;kenneth&#39;))
&lt;Response [200]&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æµå¼ä¼ è¾“è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#æµå¼ä¼ è¾“è¯·æ±‚" aria-hidden="true">#</a> æµå¼ä¼ è¾“è¯·æ±‚</h2><p>ä½¿ç”¨ Response.iter_lines() æ‚¨å¯ä»¥è½»æ¾åœ°è¿­ä»£æµå¼ APIï¼Œä¾‹å¦‚ Twitter æµå¼ APIã€‚åªéœ€å°† stream è®¾ç½®ä¸º True å¹¶ä½¿ç”¨ iter_lines è¿­ä»£å“åº”ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>import json
import requests

r = requests.get(&#39;https://httpbin.org/stream/20&#39;, stream=True)

for line in r.iter_lines():

    # filter out keep-alive new lines
    if line:
        decoded_line = line.decode(&#39;utf-8&#39;)
        print(json.loads(decoded_line))
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å°† decode_unicode=True ä¸ Response.iter_lines() æˆ– Response.iter_content() ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œæ‚¨éœ€è¦æä¾›ä¸€ç§å¤‡ç”¨ç¼–ç ï¼Œä»¥é˜²æœåŠ¡å™¨ä¸æä¾›ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>r = requests.get(&#39;https://httpbin.org/stream/20&#39;, stream=True)

if r.encoding is None:
    r.encoding = &#39;utf-8&#39;

for line in r.iter_lines(decode_unicode=True):
    if line:
        print(json.loads(line))
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è­¦å‘Š</p><p>iter_lines ä¸æ˜¯å¯é‡å…¥å®‰å…¨çš„ã€‚å¤šæ¬¡è°ƒç”¨æ­¤æ–¹æ³•ä¼šå¯¼è‡´éƒ¨åˆ†æ¥æ”¶åˆ°çš„æ•°æ®ä¸¢å¤±ã€‚å¦‚æœæ‚¨éœ€è¦ä»å¤šä¸ªä½ç½®è°ƒç”¨å®ƒï¼Œè¯·æ”¹ç”¨ç”Ÿæˆçš„è¿­ä»£å™¨å¯¹è±¡ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>lines = r.iter_lines()
# Save the first line for later or just skip it

first_line = next(lines)

for line in lines:
    print(line)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ä»£ç†-proxy" tabindex="-1"><a class="header-anchor" href="#ä»£ç†-proxy" aria-hidden="true">#</a> ä»£ç†(Proxy)</h2><p>å¦‚æœæ‚¨éœ€è¦ä½¿ç”¨ä»£ç†ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»£ç†å‚æ•°ä¸ºä»»ä½•è¯·æ±‚æ–¹æ³•é…ç½®å•ä¸ªè¯·æ±‚ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>import requests

proxies = {
  &#39;http&#39;: &#39;http://10.10.1.10:3128&#39;,
  &#39;https&#39;: &#39;http://10.10.1.10:1080&#39;,
}

requests.get(&#39;http://example.org&#39;, proxies=proxies)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä¸ºæ•´ä¸ªä¼šè¯é…ç½®ä¸€æ¬¡ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>import requests

proxies = {
  &#39;http&#39;: &#39;http://10.10.1.10:3128&#39;,
  &#39;https&#39;: &#39;http://10.10.1.10:1080&#39;,
}
session = requests.Session()
session.proxies.update(proxies)

session.get(&#39;http://example.org&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è­¦å‘Š</p><p>è®¾ç½® session.proxies çš„è¡Œä¸ºå¯èƒ½ä¸é¢„æœŸä¸åŒã€‚æä¾›çš„å€¼å°†è¢«ç¯å¢ƒä»£ç†ï¼ˆç”± urllib.request.getproxies è¿”å›çš„é‚£äº›ï¼‰è¦†ç›–ã€‚ä¸ºäº†ç¡®ä¿åœ¨å­˜åœ¨ç¯å¢ƒä»£ç†çš„æƒ…å†µä¸‹ä½¿ç”¨ä»£ç†ï¼Œè¯·åœ¨æ‰€æœ‰å•ç‹¬çš„è¯·æ±‚ä¸­æ˜ç¡®æŒ‡å®šä»£ç†å‚æ•°ï¼Œå¦‚ä¸Šæ–‡æœ€åˆæ‰€è¿°ã€‚</p><p>æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…#2018ã€‚</p><p>å¦‚ä¸Šæ‰€ç¤ºï¼Œå½“æ¯ä¸ªè¯·æ±‚æœªè¦†ç›–ä»£ç†é…ç½®æ—¶ï¼Œè¯·æ±‚ä¾èµ–äºç”±æ ‡å‡†ç¯å¢ƒå˜é‡ http_proxyã€https_proxyã€no_proxy å’Œ all_proxy å®šä¹‰çš„ä»£ç†é…ç½®ã€‚è¿˜æ”¯æŒè¿™äº›å˜é‡çš„å¤§å†™å˜ä½“ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥å°†å®ƒä»¬è®¾ç½®ä¸ºé…ç½®è¯·æ±‚ï¼ˆä»…è®¾ç½®ä¸æ‚¨çš„éœ€æ±‚ç›¸å…³çš„è¯·æ±‚ï¼‰ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ export HTTP_PROXY=&quot;http://10.10.1.10:3128&quot;
$ export HTTPS_PROXY=&quot;http://10.10.1.10:1080&quot;
$ export ALL_PROXY=&quot;socks5://10.10.1.10:3434&quot;

$ python
&gt;&gt;&gt; import requests
&gt;&gt;&gt; requests.get(&#39;http://example.org&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦å°† HTTP Basic Auth ä¸æ‚¨çš„ä»£ç†ä¸€èµ·ä½¿ç”¨ï¼Œè¯·åœ¨ä¸Šè¿°ä»»ä½•é…ç½®æ¡ç›®ä¸­ä½¿ç”¨ <a href="http://user:password@host/" target="_blank" rel="noopener noreferrer">http://user:password@host/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> è¯­æ³•ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ export HTTPS_PROXY=&quot;http://user:pass@10.10.1.10:1080&quot;

$ python
&gt;&gt;&gt; proxies = {&#39;http&#39;: &#39;http://user:pass@10.10.1.10:3128/&#39;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è­¦å‘Š</p><p>å°†æ•æ„Ÿçš„ç”¨æˆ·åå’Œå¯†ç ä¿¡æ¯å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡æˆ–ç‰ˆæœ¬æ§åˆ¶æ–‡ä»¶ä¸­å­˜åœ¨å®‰å…¨é£é™©ï¼Œå¼ºçƒˆå»ºè®®ä¸è¦è¿™æ ·åšã€‚</p><p>è¦ä¸ºç‰¹å®šæ–¹æ¡ˆå’Œä¸»æœºæä¾›ä»£ç†ï¼Œè¯·ä½¿ç”¨ scheme://hostname å½¢å¼ä½œä¸ºå¯†é’¥ã€‚è¿™å°†åŒ¹é…å¯¹ç»™å®šæ–¹æ¡ˆå’Œç¡®åˆ‡ä¸»æœºåçš„ä»»ä½•è¯·æ±‚ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>proxies = {&#39;http://10.20.1.128&#39;: &#39;http://10.10.1.10:5323&#39;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¯·æ³¨æ„ï¼Œä»£ç† URL å¿…é¡»åŒ…å«æ–¹æ¡ˆã€‚</p><p>æœ€åï¼Œè¯·æ³¨æ„ï¼Œä½¿ç”¨ä»£ç†è¿›è¡Œ https è¿æ¥é€šå¸¸éœ€è¦æ‚¨çš„æœ¬åœ°è®¡ç®—æœºä¿¡ä»»ä»£ç†çš„æ ¹è¯ä¹¦ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ‰¾åˆ°è¯·æ±‚ä¿¡ä»»çš„è¯ä¹¦åˆ—è¡¨ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>from requests.utils import DEFAULT_CA_BUNDLE_PATH
print(DEFAULT_CA_BUNDLE_PATH)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‚¨å¯ä»¥é€šè¿‡å°† REQUESTS_CA_BUNDLEï¼ˆæˆ– CURL_CA_BUNDLEï¼‰ç¯å¢ƒå˜é‡è®¾ç½®ä¸ºå¦ä¸€ä¸ªæ–‡ä»¶è·¯å¾„æ¥è¦†ç›–æ­¤é»˜è®¤è¯ä¹¦åŒ…ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ export REQUESTS_CA_BUNDLE=&quot;/usr/local/myproxy_info/cacert.pem&quot;
$ export https_proxy=&quot;http://10.10.1.10:1080&quot;

$ python
&gt;&gt;&gt; import requests
&gt;&gt;&gt; requests.get(&#39;https://example.org&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="socks5" tabindex="-1"><a class="header-anchor" href="#socks5" aria-hidden="true">#</a> Socks5</h3><p><em>ç‰ˆæœ¬ 2.10.0 ä¸­çš„æ–°åŠŸèƒ½ã€‚</em></p><p>é™¤äº†åŸºæœ¬çš„ HTTP ä»£ç†ä¹‹å¤–ï¼ŒRequests è¿˜æ”¯æŒä½¿ç”¨ SOCKS åè®®çš„ä»£ç†ã€‚è¿™æ˜¯ä¸€é¡¹å¯é€‰åŠŸèƒ½ï¼Œéœ€è¦åœ¨ä½¿ç”¨å‰å®‰è£…å…¶ä»–ç¬¬ä¸‰æ–¹åº“ã€‚</p><p>æ‚¨å¯ä»¥ä» pip è·å–æ­¤åŠŸèƒ½çš„ä¾èµ–é¡¹ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>pip install requests[socks]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¸€æ—¦ä½ å®‰è£…äº†è¿™äº›ä¾èµ–é¡¹ï¼Œä½¿ç”¨ SOCKS ä»£ç†å°±åƒä½¿ç”¨ HTTP ä¸€æ ·ç®€å•ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>proxies = {
    &#39;http&#39;: &#39;socks5://user:pass@host:port&#39;,
    &#39;https&#39;: &#39;socks5://user:pass@host:port&#39;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨æ–¹æ¡ˆ socks5 ä¼šå¯¼è‡´ DNS è§£æå‘ç”Ÿåœ¨å®¢æˆ·ç«¯ä¸Šï¼Œè€Œä¸æ˜¯ä»£ç†æœåŠ¡å™¨ä¸Šã€‚è¿™ä¸ curl ä¸€è‡´ï¼Œå®ƒä½¿ç”¨è¯¥æ–¹æ¡ˆæ¥å†³å®šæ˜¯åœ¨å®¢æˆ·ç«¯è¿˜æ˜¯ä»£ç†ä¸Šè¿›è¡Œ DNS è§£æã€‚å¦‚æœè¦è§£æä»£ç†æœåŠ¡å™¨ä¸Šçš„åŸŸï¼Œè¯·ä½¿ç”¨ socks5h ä½œä¸ºæ–¹æ¡ˆã€‚</p><h2 id="éµå®ˆè§„èŒƒ" tabindex="-1"><a class="header-anchor" href="#éµå®ˆè§„èŒƒ" aria-hidden="true">#</a> éµå®ˆè§„èŒƒ</h2><p>Requests æ—¨åœ¨ç¬¦åˆæ‰€æœ‰ç›¸å…³è§„èŒƒå’Œ RFCï¼Œè¿™äº›è§„èŒƒå’Œ RFC ä¸ä¼šç»™ç”¨æˆ·å¸¦æ¥å›°éš¾ã€‚è¿™ç§å¯¹è§„èŒƒçš„å…³æ³¨å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›å¯¹ä¸ç†Ÿæ‚‰ç›¸å…³è§„èŒƒçš„äººæ¥è¯´å¯èƒ½çœ‹èµ·æ¥ä¸å¯»å¸¸çš„è¡Œä¸ºã€‚</p><h3 id="ç¼–ç -1" tabindex="-1"><a class="header-anchor" href="#ç¼–ç -1" aria-hidden="true">#</a> ç¼–ç </h3><p>å½“æ‚¨æ”¶åˆ°å“åº”æ—¶ï¼ŒRequests ä¼šåœ¨æ‚¨è®¿é—® Response.text å±æ€§æ—¶çŒœæµ‹ç”¨äºè§£ç å“åº”çš„ç¼–ç ã€‚è¯·æ±‚å°†é¦–å…ˆæ£€æŸ¥ HTTP æ ‡å¤´ä¸­çš„ç¼–ç ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°†ä½¿ç”¨ charset_normalizer æˆ– chardet å°è¯•çŒœæµ‹ç¼–ç ã€‚</p><p>å¦‚æœå®‰è£…äº† chardetï¼Œåˆ™ requests ä½¿ç”¨å®ƒï¼Œä½†æ˜¯å¯¹äº python3 chardet ä¸å†æ˜¯å¼ºåˆ¶ä¾èµ–é¡¹ã€‚ chardet åº“æ˜¯ä¸€ä¸ª LGPL è®¸å¯çš„ä¾èµ–é¡¹ï¼Œä¸€äº›è¯·æ±‚ç”¨æˆ·ä¸èƒ½ä¾èµ–äºå¼ºåˆ¶æ€§ LGPL è®¸å¯çš„ä¾èµ–é¡¹ã€‚</p><p>å½“æ‚¨å®‰è£…è¯·æ±‚æ—¶æœªæŒ‡å®šé¢å¤–çš„ [use_chardet_on_py3]ï¼Œå¹¶ä¸”å°šæœªå®‰è£… chardetï¼Œè¯·æ±‚ä½¿ç”¨ charset-normalizerï¼ˆMIT è®¸å¯ï¼‰æ¥çŒœæµ‹ç¼–ç ã€‚</p><p>Requests å”¯ä¸€ä¸ä¼šçŒœæµ‹ç¼–ç çš„æƒ…å†µæ˜¯ HTTP æ ‡å¤´ä¸­ä¸å­˜åœ¨æ˜¾å¼å­—ç¬¦é›†å¹¶ä¸” Content-Type æ ‡å¤´åŒ…å«æ–‡æœ¬ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒRFC 2616 æŒ‡å®šé»˜è®¤å­—ç¬¦é›†å¿…é¡»æ˜¯ ISO-8859-1ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·æ±‚éµå¾ªè§„èŒƒã€‚å¦‚æœæ‚¨éœ€è¦ä¸åŒçš„ç¼–ç ï¼Œæ‚¨å¯ä»¥æ‰‹åŠ¨è®¾ç½® Response.encoding å±æ€§ï¼Œæˆ–ä½¿ç”¨åŸå§‹çš„ Response.contentã€‚</p><h2 id="http-åŠ¨è¯" tabindex="-1"><a class="header-anchor" href="#http-åŠ¨è¯" aria-hidden="true">#</a> HTTP åŠ¨è¯</h2><p>Requests æä¾›å¯¹å‡ ä¹æ‰€æœ‰ HTTP åŠ¨è¯çš„è®¿é—®ï¼šGETã€OPTIONSã€HEADã€POSTã€PUTã€PATCH å’Œ DELETEã€‚ä¸‹é¢æä¾›äº†ä½¿ç”¨ GitHub API åœ¨è¯·æ±‚ä¸­ä½¿ç”¨è¿™äº›ä¸åŒåŠ¨è¯çš„è¯¦ç»†ç¤ºä¾‹ã€‚</p><p>æˆ‘ä»¬å°†ä»æœ€å¸¸ç”¨çš„åŠ¨è¯å¼€å§‹ï¼šGETã€‚ HTTP GET æ˜¯ä¸€ç§ä»ç»™å®š URL è¿”å›èµ„æºçš„å¹‚ç­‰æ–¹æ³•ã€‚å› æ­¤ï¼Œå®ƒæ˜¯æ‚¨åœ¨å°è¯•ä» Web ä½ç½®æ£€ç´¢æ•°æ®æ—¶åº”è¯¥ä½¿ç”¨çš„åŠ¨è¯ã€‚ä¸€ä¸ªç¤ºä¾‹ç”¨æ³•æ˜¯å°è¯•ä» GitHub è·å–æœ‰å…³ç‰¹å®šæäº¤çš„ä¿¡æ¯ã€‚å‡è®¾æˆ‘ä»¬æƒ³è¦åœ¨ Requests ä¸Šæäº¤ a050fafã€‚æˆ‘ä»¬ä¼šè¿™æ ·å¾—åˆ°å®ƒï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; import requests
&gt;&gt;&gt; r = requests.get(&#39;https://api.github.com/repos/psf/requests/git/commits/a050faf084662f3a352dd1a941f2c7c9f886d4ad&#39;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬åº”è¯¥ç¡®è®¤ GitHub å“åº”æ­£ç¡®ã€‚å¦‚æœæœ‰ï¼Œæˆ‘ä»¬æƒ³å¼„æ¸…æ¥šå®ƒæ˜¯ä»€ä¹ˆç±»å‹çš„å†…å®¹ã€‚è¿™æ ·åšï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; if r.status_code == requests.codes.ok:
...     print(r.headers[&#39;content-type&#39;])
...
application/json; charset=utf-8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å› æ­¤ï¼ŒGitHub è¿”å› JSONã€‚å¤ªå¥½äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ r.json æ–¹æ³•å°†å…¶è§£æä¸º Python å¯¹è±¡ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; commit_data = r.json()

&gt;&gt;&gt; print(commit_data.keys())
[&#39;committer&#39;, &#39;author&#39;, &#39;url&#39;, &#39;tree&#39;, &#39;sha&#39;, &#39;parents&#39;, &#39;message&#39;]

&gt;&gt;&gt; print(commit_data[&#39;committer&#39;])
{&#39;date&#39;: &#39;2012-05-10T11:10:50-07:00&#39;, &#39;email&#39;: &#39;me@kennethreitz.com&#39;, &#39;name&#39;: &#39;Kenneth Reitz&#39;}

&gt;&gt;&gt; print(commit_data[&#39;message&#39;])
makin&#39; history
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå¦‚æ­¤ç®€å•ã€‚å¥½å§ï¼Œè®©æˆ‘ä»¬ç¨å¾®ç ”ç©¶ä¸€ä¸‹ GitHub APIã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æ–‡æ¡£ï¼Œä½†å¦‚æœæˆ‘ä»¬ä½¿ç”¨ Requests ä»£æ›¿ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæ›´æœ‰è¶£ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Requests OPTIONS åŠ¨è¯æ¥æŸ¥çœ‹æˆ‘ä»¬åˆšåˆšä½¿ç”¨çš„ url æ”¯æŒå“ªäº›ç±»å‹çš„ HTTP æ–¹æ³•ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; verbs = requests.options(r.url)
&gt;&gt;&gt; verbs.status_code
500
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‘ƒï¼Œä»€ä¹ˆï¼Ÿé‚£æ˜¯æ— ç›Šçš„ï¼äº‹å®è¯æ˜ GitHub å’Œè®¸å¤š API æä¾›è€…ä¸€æ ·ï¼Œå®é™…ä¸Šå¹¶æ²¡æœ‰å®ç° OPTIONS æ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªä»¤äººè®¨åŒçš„ç–å¿½ï¼Œä½†æ²¡å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ— èŠçš„æ–‡æ¡£ã€‚ä½†æ˜¯ï¼Œå¦‚æœ GitHub æ­£ç¡®å®ç°äº† OPTIONSï¼Œå®ƒä»¬åº”è¯¥åœ¨æ ‡å¤´ä¸­è¿”å›å…è®¸çš„æ–¹æ³•ï¼Œä¾‹å¦‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; verbs = requests.options(&#39;http://a-good-website.com/api/cats&#39;)
&gt;&gt;&gt; print(verbs.headers[&#39;allow&#39;])
GET,HEAD,POST,OPTIONS
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è½¬å‘æ–‡æ¡£ï¼Œæˆ‘ä»¬çœ‹åˆ°å”¯ä¸€å…è®¸æäº¤çš„å…¶ä»–æ–¹æ³•æ˜¯ POSTï¼Œå®ƒåˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤ã€‚å½“æˆ‘ä»¬ä½¿ç”¨ Requests å­˜å‚¨åº“æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½åº”è¯¥é¿å…å¯¹å…¶è¿›è¡Œç²—æš´çš„ POSTSã€‚ç›¸åï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ GitHub çš„é—®é¢˜åŠŸèƒ½ã€‚</p><p>æ·»åŠ æ­¤æ–‡æ¡£ä»¥å“åº”é—®é¢˜ #482ã€‚é‰´äºæ­¤é—®é¢˜å·²ç»å­˜åœ¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒä½œä¸ºç¤ºä¾‹ã€‚è®©æˆ‘ä»¬ä»å¾—åˆ°å®ƒå¼€å§‹ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r = requests.get(&#39;https://api.github.com/repos/psf/requests/issues/482&#39;)
&gt;&gt;&gt; r.status_code
200

&gt;&gt;&gt; issue = json.loads(r.text)

&gt;&gt;&gt; print(issue[&#39;title&#39;])
Feature any http verb in docs

&gt;&gt;&gt; print(issue[&#39;comments&#39;])
3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¾ˆé…·ï¼Œæˆ‘ä»¬æœ‰ä¸‰ä¸ªè¯„è®ºã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹ä»–ä»¬ä¸­çš„æœ€åä¸€ä¸ªã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r = requests.get(r.url + &#39;/comments&#39;)
&gt;&gt;&gt; r.status_code
200

&gt;&gt;&gt; comments = r.json()

&gt;&gt;&gt; print(comments[0].keys())
[&#39;body&#39;, &#39;url&#39;, &#39;created_at&#39;, &#39;updated_at&#39;, &#39;user&#39;, &#39;id&#39;]

&gt;&gt;&gt; print(comments[2][&#39;body&#39;])
Probably in the &quot;advanced&quot; section
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å—¯ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªæ„šè ¢çš„åœ°æ–¹ã€‚è®©æˆ‘ä»¬å‘è¡¨ä¸€æ¡è¯„è®ºï¼Œå‘Šè¯‰æµ·æŠ¥ä»–å¾ˆå‚»ã€‚åˆ°åº•æ˜¯è°çš„æµ·æŠ¥ï¼Ÿ</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; print(comments[2][&#39;user&#39;][&#39;login&#39;])
kennethreitz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¥½çš„ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å‘Šè¯‰è¿™ä¸ª Kenneth å®¶ä¼™ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™ä¸ªç¤ºä¾‹åº”è¯¥æ”¾åœ¨å¿«é€Ÿå…¥é—¨æŒ‡å—ä¸­ã€‚æ ¹æ® GitHub API æ–‡æ¡£ï¼Œæ‰§è¡Œæ­¤æ“ä½œçš„æ–¹æ³•æ˜¯ POST åˆ°çº¿ç¨‹ã€‚æˆ‘ä»¬å¼€å§‹åšå§ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; body = json.dumps({u&quot;body&quot;: u&quot;Sounds great! I&#39;ll get right on it!&quot;})
&gt;&gt;&gt; url = u&quot;https://api.github.com/repos/psf/requests/issues/482/comments&quot;

&gt;&gt;&gt; r = requests.post(url=url, data=body)
&gt;&gt;&gt; r.status_code
404
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‘µå‘µï¼Œè¿™å¾ˆå¥‡æ€ªã€‚æˆ‘ä»¬å¯èƒ½éœ€è¦è¿›è¡Œèº«ä»½éªŒè¯ã€‚é‚£ä¼šå¾ˆç—›è‹¦ï¼Œå¯¹å§ï¼Ÿé”™è¯¯çš„ã€‚ Requests ä½¿ä½¿ç”¨å¤šç§å½¢å¼çš„èº«ä»½éªŒè¯å˜å¾—å®¹æ˜“ï¼ŒåŒ…æ‹¬éå¸¸å¸¸è§çš„åŸºæœ¬èº«ä»½éªŒè¯ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; from requests.auth import HTTPBasicAuth
&gt;&gt;&gt; auth = HTTPBasicAuth(&#39;fake@example.com&#39;, &#39;not_a_real_password&#39;)

&gt;&gt;&gt; r = requests.post(url=url, data=body, auth=auth)
&gt;&gt;&gt; r.status_code
201

&gt;&gt;&gt; content = r.json()
&gt;&gt;&gt; print(content[&#39;body&#39;])
Sounds great! I&#39;ll get right on it.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ°å‡ºçš„ã€‚å“¦ï¼Œç­‰ç­‰ï¼Œä¸ï¼æˆ‘æƒ³è¡¥å……ä¸€ç‚¹ï¼Œè¿™éœ€è¦æˆ‘ä¸€æ®µæ—¶é—´ï¼Œå› ä¸ºæˆ‘å¿…é¡»å»å–‚æˆ‘çš„çŒ«ã€‚è¦æ˜¯æˆ‘èƒ½ç¼–è¾‘è¿™æ¡è¯„è®ºå°±å¥½äº†ï¼ä»¤äººé«˜å…´çš„æ˜¯ï¼ŒGitHub å…è®¸æˆ‘ä»¬ä½¿ç”¨å¦ä¸€ä¸ª HTTP åŠ¨è¯ PATCH æ¥ç¼–è¾‘æ­¤è¯„è®ºã€‚è®©æˆ‘ä»¬è¿™æ ·åšã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; print(content[u&quot;id&quot;])
5804413

&gt;&gt;&gt; body = json.dumps({u&quot;body&quot;: u&quot;Sounds great! I&#39;ll get right on it once I feed my cat.&quot;})
&gt;&gt;&gt; url = u&quot;https://api.github.com/repos/psf/requests/issues/comments/5804413&quot;

&gt;&gt;&gt; r = requests.patch(url=url, data=body, auth=auth)
&gt;&gt;&gt; r.status_code
200
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‡ºè‰²çš„ã€‚ç°åœ¨ï¼Œä¸ºäº†æŠ˜ç£¨è¿™ä¸ªè‚¯å°¼æ–¯å®¶ä¼™ï¼Œæˆ‘å†³å®šè®©ä»–å‡ºæ±—ï¼Œè€Œä¸æ˜¯å‘Šè¯‰ä»–æˆ‘æ­£åœ¨åŠªåŠ›ã€‚è¿™æ„å‘³ç€æˆ‘æƒ³åˆ é™¤è¿™æ¡è¯„è®ºã€‚ GitHub å…è®¸æˆ‘ä»¬ä½¿ç”¨éå¸¸è´´åˆ‡çš„ DELETE æ–¹æ³•åˆ é™¤è¯„è®ºã€‚è®©æˆ‘ä»¬æ‘†è„±å®ƒã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r = requests.delete(url=url, auth=auth)
&gt;&gt;&gt; r.status_code
204
&gt;&gt;&gt; r.headers[&#39;status&#39;]
&#39;204 No Content&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‡ºè‰²çš„ã€‚å…¨æ²¡äº†ã€‚æˆ‘æƒ³çŸ¥é“çš„æœ€åä¸€ä»¶äº‹æ˜¯æˆ‘ä½¿ç”¨äº†å¤šå°‘é€Ÿç‡é™åˆ¶ã€‚è®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ã€‚ GitHub åœ¨æ ‡å¤´ä¸­å‘é€è¯¥ä¿¡æ¯ï¼Œå› æ­¤æˆ‘å°†å‘é€ HEAD è¯·æ±‚ä»¥è·å–æ ‡å¤´ï¼Œè€Œä¸æ˜¯ä¸‹è½½æ•´ä¸ªé¡µé¢ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r = requests.head(url=url, auth=auth)
&gt;&gt;&gt; print(r.headers)
...
&#39;x-ratelimit-remaining&#39;: &#39;4995&#39;
&#39;x-ratelimit-limit&#39;: &#39;5000&#39;
...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‡ºè‰²çš„ã€‚æ˜¯æ—¶å€™ç¼–å†™ä¸€ä¸ªä»¥å„ç§ä»¤äººå…´å¥‹çš„æ–¹å¼æ»¥ç”¨ GitHub API çš„ Python ç¨‹åºäº†ï¼Œ4995 æ¬¡ä»¥ä¸Šã€‚</p><h2 id="è‡ªå®šä¹‰åŠ¨è¯" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰åŠ¨è¯" aria-hidden="true">#</a> è‡ªå®šä¹‰åŠ¨è¯</h2><p>æœ‰æ—¶ï¼Œæ‚¨å¯èƒ½ä¼šä½¿ç”¨æœåŠ¡å™¨ï¼Œæ— è®ºå‡ºäºä½•ç§åŸå› ï¼Œè¯¥æœåŠ¡å™¨å…è®¸ä½¿ç”¨ç”šè‡³éœ€è¦ä½¿ç”¨ä¸Šé¢æœªæ¶µç›–çš„ HTTP åŠ¨è¯ã€‚ä¸€ä¸ªä¾‹å­æ˜¯ä¸€äº› WEBDAV æœåŠ¡å™¨ä½¿ç”¨çš„ MKCOL æ–¹æ³•ã€‚ä¸è¦æ‹…å¿ƒï¼Œè¿™äº›ä»ç„¶å¯ä»¥ä¸è¯·æ±‚ä¸€èµ·ä½¿ç”¨ã€‚è¿™äº›ä½¿ç”¨å†…ç½®çš„ .request æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r = requests.request(&#39;MKCOL&#39;, url, data=data)
&gt;&gt;&gt; r.status_code
200 # Assuming your call was correct
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æœåŠ¡å™¨å…è®¸çš„ä»»ä½•æ–¹æ³•åŠ¨è¯ã€‚</p><h2 id="é“¾æ¥å¤´" tabindex="-1"><a class="header-anchor" href="#é“¾æ¥å¤´" aria-hidden="true">#</a> é“¾æ¥å¤´</h2><p>è®¸å¤š HTTP API éƒ½å…·æœ‰é“¾æ¥å¤´ã€‚å®ƒä»¬ä½¿ API æ›´å…·è‡ªæˆ‘æè¿°æ€§å’Œå¯å‘ç°æ€§ã€‚</p><p>GitHub åœ¨å…¶ API ä¸­ä½¿ç”¨è¿™äº›è¿›è¡Œåˆ†é¡µï¼Œä¾‹å¦‚ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; url = &#39;https://api.github.com/users/kennethreitz/repos?page=1&amp;per_page=10&#39;
&gt;&gt;&gt; r = requests.head(url=url)
&gt;&gt;&gt; r.headers[&#39;link&#39;]
&#39;&lt;https://api.github.com/users/kennethreitz/repos?page=2&amp;per_page=10&gt;; rel=&quot;next&quot;, &lt;https://api.github.com/users/kennethreitz/repos?page=6&amp;per_page=10&gt;; rel=&quot;last&quot;&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·æ±‚å°†è‡ªåŠ¨è§£æè¿™äº›é“¾æ¥å¤´å¹¶ä½¿å…¶æ˜“äºä½¿ç”¨ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; r.links[&quot;next&quot;]
{&#39;url&#39;: &#39;https://api.github.com/users/kennethreitz/repos?page=2&amp;per_page=10&#39;, &#39;rel&#39;: &#39;next&#39;}

&gt;&gt;&gt; r.links[&quot;last&quot;]
{&#39;url&#39;: &#39;https://api.github.com/users/kennethreitz/repos?page=7&amp;per_page=10&#39;, &#39;rel&#39;: &#39;last&#39;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ä¼ è¾“é€‚é…å™¨" tabindex="-1"><a class="header-anchor" href="#ä¼ è¾“é€‚é…å™¨" aria-hidden="true">#</a> ä¼ è¾“é€‚é…å™¨</h2><p>ä» v1.0.0 å¼€å§‹ï¼ŒRequests å·²è½¬å‘æ¨¡å—åŒ–å†…éƒ¨è®¾è®¡ã€‚è¿™æ ·åšçš„éƒ¨åˆ†åŸå› æ˜¯ä¸ºäº†å®ç°ä¼ è¾“é€‚é…å™¨ï¼Œæœ€åˆåœ¨æ­¤å¤„æè¿°ã€‚ä¼ è¾“é€‚é…å™¨æä¾›äº†ä¸€ç§æœºåˆ¶æ¥å®šä¹‰ HTTP æœåŠ¡çš„äº¤äº’æ–¹æ³•ã€‚ç‰¹åˆ«æ˜¯ï¼Œå®ƒä»¬å…è®¸æ‚¨åº”ç”¨æ¯ä¸ªæœåŠ¡çš„é…ç½®ã€‚</p><p>è¯·æ±‚é™„å¸¦ä¸€ä¸ªä¼ è¾“é€‚é…å™¨ï¼Œå³ HTTPAdapterã€‚æ­¤é€‚é…å™¨ä½¿ç”¨å¼ºå¤§çš„ urllib3 åº“æä¾›ä¸ HTTP å’Œ HTTPS çš„é»˜è®¤è¯·æ±‚äº¤äº’ã€‚æ¯å½“åˆå§‹åŒ– Requests Session æ—¶ï¼Œå…¶ä¸­ä¸€ä¸ªé™„åŠ åˆ° HTTP çš„ Session å¯¹è±¡ï¼Œä¸€ä¸ªé™„åŠ åˆ° HTTPSã€‚</p><p>Requests ä½¿ç”¨æˆ·èƒ½å¤Ÿåˆ›å»ºå’Œä½¿ç”¨ä»–ä»¬è‡ªå·±çš„æä¾›ç‰¹å®šåŠŸèƒ½çš„ä¼ è¾“é€‚é…å™¨ã€‚åˆ›å»ºåï¼Œå¯ä»¥å°†ä¼ è¾“é€‚é…å™¨å®‰è£…åˆ° Session å¯¹è±¡ï¼Œä»¥åŠå®ƒåº”è¯¥åº”ç”¨äºå“ªäº› Web æœåŠ¡çš„æŒ‡ç¤ºã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt;&gt;&gt; s = requests.Session()
&gt;&gt;&gt; s.mount(&#39;https://github.com/&#39;, MyAdapter())
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æŒ‚è½½è°ƒç”¨å°†ä¼ è¾“é€‚é…å™¨çš„ç‰¹å®šå®ä¾‹æ³¨å†Œåˆ°å‰ç¼€ã€‚å®‰è£…åï¼Œä½¿ç”¨ URL ä»¥ç»™å®šå‰ç¼€å¼€å¤´çš„ä¼šè¯å‘å‡ºçš„ä»»ä½• HTTP è¯·æ±‚éƒ½å°†ä½¿ç”¨ç»™å®šçš„ä¼ è¾“é€‚é…å™¨ã€‚</p><p>å®ç°ä¼ è¾“é€‚é…å™¨çš„è®¸å¤šç»†èŠ‚è¶…å‡ºäº†æœ¬æ–‡æ¡£çš„èŒƒå›´ï¼Œä½†è¯·çœ‹ä¸‹ä¸€ä¸ªç®€å• SSL ç”¨ä¾‹çš„ç¤ºä¾‹ã€‚ä¸ä»…å¦‚æ­¤ï¼Œæ‚¨è¿˜å¯ä»¥æŸ¥çœ‹ BaseAdapter çš„å­ç±»åŒ–ã€‚</p><h3 id="ç¤ºä¾‹-ç‰¹å®š-ssl-ç‰ˆæœ¬" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-ç‰¹å®š-ssl-ç‰ˆæœ¬" aria-hidden="true">#</a> ç¤ºä¾‹ï¼šç‰¹å®š SSL ç‰ˆæœ¬</h3><p>Requests å›¢é˜Ÿå·²åšå‡ºç‰¹å®šé€‰æ‹©ï¼Œä»¥ä½¿ç”¨åŸºç¡€åº“ (urllib3) ä¸­é»˜è®¤çš„ä»»ä½• SSL ç‰ˆæœ¬ã€‚é€šå¸¸è¿™å¾ˆå¥½ï¼Œä½†æœ‰æ—¶ï¼Œæ‚¨å¯èƒ½ä¼šå‘ç°è‡ªå·±éœ€è¦è¿æ¥åˆ°ä½¿ç”¨ä¸é»˜è®¤ç‰ˆæœ¬ä¸å…¼å®¹çš„æœåŠ¡ç«¯ç‚¹ã€‚</p><p>æ‚¨å¯ä»¥ä¸ºæ­¤ä½¿ç”¨ä¼ è¾“é€‚é…å™¨ï¼Œæ–¹æ³•æ˜¯é‡‡ç”¨å¤§éƒ¨åˆ†ç°æœ‰çš„ HTTPAdapter å®ç°ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªä¼ é€’ç»™ urllib3 çš„å‚æ•° ssl_versionã€‚æˆ‘ä»¬å°†åˆ¶ä½œä¸€ä¸ªä¼ è¾“é€‚é…å™¨ï¼ŒæŒ‡ç¤ºåº“ä½¿ç”¨ SSLv3ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>import ssl
from urllib3.poolmanager import PoolManager

from requests.adapters import HTTPAdapter


class Ssl3HttpAdapter(HTTPAdapter):
    &quot;&quot;&quot;&quot;Transport adapter&quot; that allows us to use SSLv3.&quot;&quot;&quot;

    def init_poolmanager(self, connections, maxsize, block=False):
        self.poolmanager = PoolManager(
            num_pools=connections, maxsize=maxsize,
            block=block, ssl_version=ssl.PROTOCOL_SSLv3)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="é˜»å¡è¿˜æ˜¯éé˜»å¡" tabindex="-1"><a class="header-anchor" href="#é˜»å¡è¿˜æ˜¯éé˜»å¡" aria-hidden="true">#</a> é˜»å¡è¿˜æ˜¯éé˜»å¡ï¼Ÿ</h2><p>ä½¿ç”¨é»˜è®¤ä¼ è¾“é€‚é…å™¨ï¼ŒRequests ä¸æä¾›ä»»ä½•ç±»å‹çš„éé˜»å¡ IOã€‚ Response.content å±æ€§å°†è¢«é˜»å¡ï¼Œç›´åˆ°æ•´ä¸ªå“åº”è¢«ä¸‹è½½ã€‚å¦‚æœæ‚¨éœ€è¦æ›´å¤šç²’åº¦ï¼Œåº“çš„æµå¼ä¼ è¾“åŠŸèƒ½ï¼ˆè¯·å‚é˜…æµå¼ä¼ è¾“è¯·æ±‚ï¼‰å…è®¸æ‚¨ä¸€æ¬¡æ£€ç´¢æ›´å°‘é‡çš„å“åº”ã€‚ä½†æ˜¯ï¼Œè¿™äº›è°ƒç”¨ä»å°†é˜»å¡ã€‚</p><p>å¦‚æœæ‚¨æ‹…å¿ƒé˜»å¡ IO çš„ä½¿ç”¨ï¼Œæœ‰å¾ˆå¤šé¡¹ç›®å°†è¯·æ±‚ä¸ Python çš„å¼‚æ­¥æ¡†æ¶ä¹‹ä¸€ç»“åˆèµ·æ¥ã€‚ä¸€äº›ä¼˜ç§€çš„ä¾‹å­æ˜¯ requests-threadsã€grequestsã€requests-futures å’Œ httpxã€‚</p><h2 id="æ ‡é¢˜æ’åº" tabindex="-1"><a class="header-anchor" href="#æ ‡é¢˜æ’åº" aria-hidden="true">#</a> æ ‡é¢˜æ’åº</h2><p>åœ¨ä¸å¯»å¸¸çš„æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½å¸Œæœ›ä»¥æœ‰åºçš„æ–¹å¼æä¾›æ ‡é¢˜ã€‚å¦‚æœæ‚¨å°† OrderedDict ä¼ é€’ç»™ headers å…³é”®å­—å‚æ•°ï¼Œåˆ™ä¼šä¸ºæ ‡é¢˜æä¾›æ’åºã€‚ä½†æ˜¯ï¼Œè¯·æ±‚ä½¿ç”¨çš„é»˜è®¤æ ‡å¤´çš„é¡ºåºå°†æ˜¯é¦–é€‰ï¼Œè¿™æ„å‘³ç€å¦‚æœæ‚¨åœ¨ headers å…³é”®å­—å‚æ•°ä¸­è¦†ç›–é»˜è®¤æ ‡å¤´ï¼Œä¸è¯¥å…³é”®å­—å‚æ•°ä¸­çš„å…¶ä»–æ ‡å¤´ç›¸æ¯”ï¼Œå®ƒä»¬å¯èƒ½ä¼šå‡ºç°ä¹±åºã€‚</p><p>å¦‚æœè¿™æ˜¯æœ‰é—®é¢˜çš„ï¼Œç”¨æˆ·åº”è¯¥è€ƒè™‘é€šè¿‡å°† Session è®¾ç½®ä¸ºè‡ªå®šä¹‰ OrderedDict æ¥è®¾ç½® Session å¯¹è±¡çš„é»˜è®¤æ ‡å¤´ã€‚è¯¥æ’åºå°†å§‹ç»ˆæ˜¯é¦–é€‰ã€‚</p><h2 id="è¶…æ—¶-1" tabindex="-1"><a class="header-anchor" href="#è¶…æ—¶-1" aria-hidden="true">#</a> è¶…æ—¶</h2><p>å¤§å¤šæ•°å¯¹å¤–éƒ¨æœåŠ¡å™¨çš„è¯·æ±‚éƒ½åº”è¯¥é™„åŠ è¶…æ—¶ï¼Œä»¥é˜²æœåŠ¡å™¨æ²¡æœ‰åŠæ—¶å“åº”ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œé™¤éæ˜ç¡®è®¾ç½®è¶…æ—¶å€¼ï¼Œå¦åˆ™è¯·æ±‚ä¸ä¼šè¶…æ—¶ã€‚å¦‚æœæ²¡æœ‰è¶…æ—¶ï¼Œæ‚¨çš„ä»£ç å¯èƒ½ä¼šæŒ‚èµ·å‡ åˆ†é’Ÿæˆ–æ›´é•¿æ—¶é—´ã€‚</p><p>è¿æ¥è¶…æ—¶æ˜¯è¯·æ±‚å°†ç­‰å¾…æ‚¨çš„å®¢æˆ·ç«¯åœ¨å¥—æ¥å­—ä¸Šå»ºç«‹ä¸è¿œç¨‹æœºå™¨çš„è¿æ¥ï¼ˆå¯¹åº”äº connect()ï¼‰è°ƒç”¨çš„ç§’æ•°ã€‚æœ€å¥½å°†è¿æ¥è¶…æ—¶è®¾ç½®ä¸ºç•¥å¤§äº 3 çš„å€æ•°ï¼Œè¿™æ˜¯é»˜è®¤çš„ TCP æ•°æ®åŒ…é‡ä¼ çª—å£ã€‚</p><p>ä¸€æ—¦æ‚¨çš„å®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡å™¨å¹¶å‘é€ HTTP è¯·æ±‚ï¼Œè¯»å–è¶…æ—¶å°±æ˜¯å®¢æˆ·ç«¯ç­‰å¾…æœåŠ¡å™¨å‘é€å“åº”çš„ç§’æ•°ã€‚ ï¼ˆå…·ä½“æ¥è¯´ï¼Œå®ƒæ˜¯å®¢æˆ·ç«¯åœ¨ä»æœåŠ¡å™¨å‘é€çš„å­—èŠ‚ä¹‹é—´ç­‰å¾…çš„ç§’æ•°ã€‚åœ¨ 99.9% çš„æƒ…å†µä¸‹ï¼Œè¿™æ˜¯æœåŠ¡å™¨å‘é€ç¬¬ä¸€ä¸ªå­—èŠ‚ä¹‹å‰çš„æ—¶é—´ï¼‰ã€‚</p><p>å¦‚æœæ‚¨ä¸ºè¶…æ—¶æŒ‡å®šå•ä¸ªå€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>r = requests.get(&#39;https://github.com&#39;, timeout=5)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¶…æ—¶å€¼å°†åº”ç”¨äºè¿æ¥è¶…æ—¶å’Œè¯»å–è¶…æ—¶ã€‚å¦‚æœæ‚¨æƒ³å•ç‹¬è®¾ç½®å€¼ï¼Œè¯·æŒ‡å®šä¸€ä¸ªå…ƒç»„ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>r = requests.get(&#39;https://github.com&#39;, timeout=(3.05, 27))
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¦‚æœè¿œç¨‹æœåŠ¡å™¨å¾ˆæ…¢ï¼Œä½ å¯ä»¥å‘Šè¯‰ Requests æ°¸è¿œç­‰å¾…å“åº”ï¼Œé€šè¿‡ä¼ é€’ None ä½œä¸ºè¶…æ—¶å€¼ï¼Œç„¶åæ£€ç´¢ä¸€æ¯å’–å•¡ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>r = requests.get(&#39;https://github.com&#39;, timeout=None)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/demo/theme-docs/src/lang/python/module/requests.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: goojoer@gmail.com">Goojoe</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/lang/python/module/pipreqs.html" class="nav-link prev" aria-label="pipreqs(ç”Ÿæˆrequirements.txt)"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->pipreqs(ç”Ÿæˆrequirements.txt)</div></a><!----></nav><!----><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-5ac1acdb.js" defer></script>
  </body>
</html>
